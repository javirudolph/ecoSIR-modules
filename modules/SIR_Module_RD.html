<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SIR Module Rough Draft</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SIR_Module_RD_files/libs/clipboard/clipboard.min.js"></script>
<script src="SIR_Module_RD_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="SIR_Module_RD_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="SIR_Module_RD_files/libs/quarto-html/popper.min.js"></script>
<script src="SIR_Module_RD_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SIR_Module_RD_files/libs/quarto-html/anchor.min.js"></script>
<link href="SIR_Module_RD_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SIR_Module_RD_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SIR_Module_RD_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SIR_Module_RD_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SIR_Module_RD_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-and-course-learning-objectives" id="toc-introduction-and-course-learning-objectives" class="nav-link active" data-scroll-target="#introduction-and-course-learning-objectives">Introduction and Course Learning Objectives</a></li>
  <li><a href="#epidemiology-terms" id="toc-epidemiology-terms" class="nav-link" data-scroll-target="#epidemiology-terms">Epidemiology Terms</a></li>
  <li><a href="#introducing-compartmental-models" id="toc-introducing-compartmental-models" class="nav-link" data-scroll-target="#introducing-compartmental-models">Introducing Compartmental Models</a>
  <ul class="collapse">
  <li><a href="#learning-assessment" id="toc-learning-assessment" class="nav-link" data-scroll-target="#learning-assessment">Learning Assessment:</a></li>
  </ul></li>
  <li><a href="#the-classic-sir-epidemic-model" id="toc-the-classic-sir-epidemic-model" class="nav-link" data-scroll-target="#the-classic-sir-epidemic-model">The Classic SIR Epidemic Model</a>
  <ul class="collapse">
  <li><a href="#formulating-the-force-of-infection" id="toc-formulating-the-force-of-infection" class="nav-link" data-scroll-target="#formulating-the-force-of-infection">Formulating the Force of Infection</a></li>
  <li><a href="#formulating-the-recovery-rate-and-other-parameters" id="toc-formulating-the-recovery-rate-and-other-parameters" class="nav-link" data-scroll-target="#formulating-the-recovery-rate-and-other-parameters">Formulating the Recovery Rate and Other Parameters</a></li>
  </ul></li>
  <li><a href="#solving-sir-equations" id="toc-solving-sir-equations" class="nav-link" data-scroll-target="#solving-sir-equations">Solving SIR Equations</a>
  <ul class="collapse">
  <li><a href="#eulers-method" id="toc-eulers-method" class="nav-link" data-scroll-target="#eulers-method">Euler’s method</a></li>
  <li><a href="#desolve-package-in-r" id="toc-desolve-package-in-r" class="nav-link" data-scroll-target="#desolve-package-in-r">deSolve Package in R</a></li>
  <li><a href="#evaluating-and-comparing-both-methods" id="toc-evaluating-and-comparing-both-methods" class="nav-link" data-scroll-target="#evaluating-and-comparing-both-methods">Evaluating and Comparing Both Methods</a></li>
  </ul></li>
  <li><a href="#reproduction-numbers" id="toc-reproduction-numbers" class="nav-link" data-scroll-target="#reproduction-numbers">Reproduction Numbers</a>
  <ul class="collapse">
  <li><a href="#the-basic-reproduction-number" id="toc-the-basic-reproduction-number" class="nav-link" data-scroll-target="#the-basic-reproduction-number">The Basic Reproduction Number</a></li>
  </ul></li>
  <li><a href="#example-of-the-classic-epidemic-model" id="toc-example-of-the-classic-epidemic-model" class="nav-link" data-scroll-target="#example-of-the-classic-epidemic-model">Example of the Classic Epidemic Model</a></li>
  <li><a href="#the-classic-endemic-model" id="toc-the-classic-endemic-model" class="nav-link" data-scroll-target="#the-classic-endemic-model">The Classic Endemic Model</a></li>
  <li><a href="#disease-free-and-endemic-equilibrium" id="toc-disease-free-and-endemic-equilibrium" class="nav-link" data-scroll-target="#disease-free-and-endemic-equilibrium">Disease Free and Endemic Equilibrium</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SIR Module Rough Draft</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction-and-course-learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="introduction-and-course-learning-objectives">Introduction and Course Learning Objectives</h2>
</section>
<section id="epidemiology-terms" class="level2">
<h2 class="anchored" data-anchor-id="epidemiology-terms">Epidemiology Terms</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Learning Objectives">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this section, you should be able to:</p>
<ul>
<li>Define basic terms in epidemiology.</li>
</ul>
</div>
</div>
<p>For the purposes of mathematical models in epidemiology, such as the SIR model, individuals are classified based solely on their ability to transmit a pathogen, not their diseased status (whether or not they exhibit symptoms). For the purposes of epidemiological models, individuals are generally classified into four primary categories:</p>
<ul>
<li><p><strong>Susceptible:</strong> No pathogen is present in the individual. The individual only has a low level of non-specific immunity to incoming infection.</p></li>
<li><p><strong>Exposed:</strong> The individual has encountered an infected individual and is infected with the pathogen. The levels of pathogen in this individual are too low to allow them to transmit the disease to another person. This individual is hence considered “exposed” to the pathogen but not yet able to infect others with it.</p></li>
<li><p><strong>Infectious:</strong> The individual has surpassed the exposed stage and the pathogen levels within them are high enough to allow for transmission. This individual is no longer just exposed to the pathogen, but can actively spread it now.</p></li>
<li><p><strong>Recovered:</strong> The individual has surpassed the infectious stage, their immune system has cleared enough of the pathogen that they can no longer transmit it. This individual has some amount of immunity to the pathogen now, but for how long this immunity lasts depends on the specific pathogen.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The individual can still exhibit symptoms of the disease while in the recovered category, so it is best to think of this category as individuals who have “recovered” from their ability to spread the infection but not necessarily all symptomatic implications of that infection.</p>
</div>
</div>
<p>These categories are not exhaustive, and individuals can be classified into further categories based on their stage of infection or immunity status, just to name a few. These four categories are highlighted since they come up most often while discussing SIR-type models and epidemiological models in general. It is important to note that, at the same time individuals fall into these categories, they can also be classified based on whether or not they exhibit symptoms of infection:</p>
<ul>
<li><p><strong>Incubation Period:</strong> The individual has been infected with the pathogen but does not show disease symptoms. This is also commonly refferred to as the <em>asymptomatic period</em>.</p></li>
<li><p><strong>Diseased period:</strong> The individual has surpassed the incubation period and begins to show symptoms of the disease.</p></li>
</ul>
<p>Although these classifications are more commonly used in a medical, rather than an epidemiological, contexts, we still provide them here to clarify the fact that an individual can still be infectious while in the incubation period and showing no symptoms of the disease. Similarly, an individual can still be in the diseased period and show lingering symptoms of infection while being recovered since their immune system has cleared enough of the pathogen that they are not longer infectious.</p>
<p>(PLACE GRAPH HERE OF ALL THESE PERIODS)</p>
<p>CITATION FOR ENTIRE SECTION: Keeling and Rohani</p>
</section>
<section id="introducing-compartmental-models" class="level2">
<h2 class="anchored" data-anchor-id="introducing-compartmental-models">Introducing Compartmental Models</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Learning Objectives">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this section, you should be able to:</p>
<ul>
<li>Define what a compartmental model is.</li>
<li>Identify which differential equation models can be called compartmental models.</li>
</ul>
</div>
</div>
<p>Generally speaking, compartmental models are a way to represent the flow of populations between different states, known as compartments, using differential equations. Compartmental models show up in a wide variety of fields, not just epidemiology. Any field that can benefit from knowing how information flows between states can benefit from compartmental models.</p>
<p>In the epidemiological context, compartmental models are analyzing how people flow through the four categories, which will be referred to simply as “compartments” from now on, introduced in the previous section: susceptible, exposed, infectious, and recovered. The relationships between these compartments are often represented using flowcharts like the one seen below.</p>
<p>(INSERT IMAGE OF SEIR FLOWCHART THAT SPECIFICALLY SHOWS LAMBDA INSTEAD OF BETA AS THE FLOW RATE BETWEEN S AND E)</p>
<p>The arrows between these compartments represent the direction of flow (susceptible individuals becoming exposed, exposed individuals becoming infectious, etc.) and the symbols above each arrow represent the <em>flow rate</em> between these compartments with respect to time.</p>
<p>It’s easiest to understand this conceptually through an example. Say in a very large population with the established presence of a pathogen, on average, 300 new people become exposed to a pathogen every day. Of those that are exposed to the pathogen, on average, 50 of them reach pathogen levels high enough to become infectious per day. Then, of those that are infectious and able to transmit the pathogen, on average, 40 of them recover from the pathogen (in the sense that they can no longer transmit it). We can model this specific example with the modified flowchart below:</p>
<p>Which compartments we choose to include depends on the specific pathogen and disease we are modeling. Models where the exposed period is so small it can be considered negligible, or is ommited for the sake of simplicity, are specifically known as <em>SIR models</em> (standing for the three different compartments included in the model: susceptible, infectious, and recovered).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Some sources will refer generally to any compartmental epidemiological model as an “SIR model,” but in our context we will make the distinction between SIR models and models that include different compartments than just susceptible, infectious, and recovered.</p>
<p>We will, however, refer to the general idea of compartmental epidemiological models as “SIR-type models.”</p>
</div>
</div>
<p>The <a href="#the-classic-sir-epidemic-model">next section</a> covers the specific formulation and assumptions of this model.</p>
<section id="learning-assessment" class="level3">
<h3 class="anchored" data-anchor-id="learning-assessment">Learning Assessment:</h3>
<p>Make assessment that’s like given what compartments these letters represent draw a flowchart for the following models like SEIR SMEIR SIS SIRS etc</p>
<p>CITATION FOR ENTIRE SECTION: Keeling and Rohani</p>
</section>
</section>
<section id="the-classic-sir-epidemic-model" class="level2">
<h2 class="anchored" data-anchor-id="the-classic-sir-epidemic-model">The Classic SIR Epidemic Model</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Learning Objectives">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this section, you should be able to:</p>
<ul>
<li><p>Recall the classic epidemic model’s equations.</p></li>
<li><p>Construct equations for novel compartmental models given the flow rates between each of the compartments.</p></li>
<li><p>Identify the assumptions (and their justifications) made in the formulation of the classic epidemic model, including the assumptions made in relation to how its parameters were obtained / formulated.</p></li>
<li><p>Recall what parameters go into the construction of the classic epidemic model, including the typical symbols for each.</p></li>
<li><p>Explain how the classic epidemic model deviates from reality in relation to the assumptions it makes.</p></li>
<li><p>Differentiate situations where an empirically deduced transmission rate is more accurate and beneficial to one calculated based on first principles.</p></li>
<li><p>Discern what situations are best modeled by frequency or density dependent transmission rates, or a combination of both.</p></li>
</ul>
</div>
</div>
<p>The classic SIR epidemic model is a type of compartmental model that makes the following key assumptions:</p>
<ol type="1">
<li><p>The epidemic invades the population and concludes itself quickly enough that demographic processes, namely births and deaths, are not very influential to the overall process and can be omitted from the model. This is also known as the <em>closed population</em> assumption.</p></li>
<li><p>Individuals move between the compartments of susceptible, infected, and recovered only. Other compartments, namely the exposed compartment, are omitted for simplicity.</p></li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There may be applications of the epidemic SIR model that justify the omission of the exposed compartment since the disease has a negligible exposed period and individuals almost immediately go to being infectious after invasion by the pathogen.</p>
</div>
</div>
<p>These are not the only assumptions made by the epidemic SIR model, but they do clearly distinguish it from other compartmental models such as the SEIR model, which includes exposed compartment, and the endemic SIR model, which includes the flow in and out of each compartment due to demographics (births and death).</p>
<p>Moving forward, <span class="math inline">\(S\)</span>. <span class="math inline">\(I\)</span>, and <span class="math inline">\(R\)</span> will refer to the <em>number</em> of individuals in the susceptible, infected, and recovered compartments, respectively. The variables <span class="math inline">\(\tilde{S}=\frac{S}{N}\)</span>, <span class="math inline">\(\tilde{I}=\frac{I}{N}\)</span>, and <span class="math inline">\(\tilde{R}=\frac{R}{N}\)</span>, will be used to refer to the <em>proportion</em> of individuals in the susceptible, infected, and recovered compartments, respectively, where <span class="math inline">\(N\)</span> is the total number of individuals in the population defined as <span class="math inline">\(N=S+I+R\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Since the epidemic model assumes a closed population with no births or deaths, <span class="math inline">\(N\)</span> is not a variable that can change but a constant.</p></li>
<li><p>Notice that <span class="math inline">\(\tilde{S}+\tilde{I}+\tilde{R}=1\)</span></p></li>
</ul>
</div>
</div>
<p>The following equations provide the rates of change, with respect to time, for the number of individuals in each of the three compartments of the epidemic SIR model:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dS}{dt} &amp;= -\lambda S \\[10pt]
\frac{dI}{dt} &amp;= \lambda S - \gamma I \\[10pt]
\frac{dR}{dt} &amp;= \gamma I
\end{aligned}
\]</span></p>
<p>Dividing each equation by the population size <span class="math inline">\(N\)</span>, we can rewrite the SIR equations above to provide the rates of change, with respect to time, for the proportion of individuals in each compartment:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{d\tilde{S}}{dt} &amp;= -\lambda \tilde{S} \\[10pt]
\frac{d\tilde{I}}{dt} &amp;= \lambda \tilde{S} - \gamma \tilde{I} \\[10pt]
\frac{d\tilde{R}}{dt} &amp;= \gamma \tilde{I}
\end{aligned}
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The rate of change of the number of people in each compartment can be understood as following the basic pattern of <span class="math inline">\(R_i-R_o\)</span> where <span class="math inline">\(R_i\)</span> is the rate that people are flowing into the compartment per unit time and <span class="math inline">\(R_o\)</span> is the rate that people are flowing out of the compartment per unit time. This pattern can be used to construct any number of novel compartmental models.</p>
</div>
</div>
<p>Notice that these equations mirror exactly the compartmental flowcharts introduced in the <a href="#introducing-compartmental-models">previous section</a>. The epidemic SIR model can be representing using the following flowchart:</p>
<p>The flow rates between each compartment have specific names and symbology, summarized in the table below:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 24%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Terminology / Name</strong></th>
<th><strong>Common Symbol</strong></th>
<th><strong>Interpretation</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Force of Infection</td>
<td><span class="math inline">\(\lambda\)</span></td>
<td>The per capita rate at which susceptible individuals are becoming infectious per unit time.</td>
</tr>
<tr class="even">
<td>Recovery Rate</td>
<td><span class="math inline">\(\gamma\)</span></td>
<td>The per capita rate at which infectious individuals are recovering from infection per unit time.</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The phrase “per capita” here refers to a rate that is divided among each person in the given compartment. Take the following example: if 3 people are pouring water into a large bucket and each are adding 5 cups per minute, then the per capita rate at which water is being added is 5 cups per minute. To obtain the total rate at which water is being poured into the bucket, we would multiply the number of people pouring, 3, by their per capita rate, 5, to get a total inflow of 15 cups per minute.</p>
<p>A similar logic is being utilized in the SIR equations: the number of susceptible people at a given time, <span class="math inline">\(S\)</span>, is multiplied by the per capita rate they are becoming infectious to get the total rate at which people are entering the infectious category. Similarly, the number of infectious people at a given time, <span class="math inline">\(I\)</span>, is multiplied by the per capita rate they are recovering to get the total rate at which people are entering the recovered category.</p>
</div>
</div>
<p>CITATION FOR ENTIRE SECTION: Keeling and Rohani</p>
<section id="formulating-the-force-of-infection" class="level3">
<h3 class="anchored" data-anchor-id="formulating-the-force-of-infection">Formulating the Force of Infection</h3>
<p>The force of infection, or the rate at which susceptible individuals are becoming infected (as well as infectious) per unit time, can be understood and formulated based on first principles in epidemiology as follows:</p>
<blockquote class="blockquote">
<p>Consider the perspective of a susceptible individual in the population at any given time. Let’s say this individual makes, on average, <span class="math inline">\(c\)</span> contacts with other people per unit time. Then, suppose that of those <span class="math inline">\(c\)</span> people this individual makes contact with per unit time, the proportion of them that will be infectious is <span class="math inline">\(\tilde{I}\)</span>. Then, of those <span class="math inline">\(c\tilde{I}\)</span> contacts this individual makes with infectious people, the proportion of them that will actually succeed at spreading the infection to them is <span class="math inline">\(p\)</span>. Multiplying these together, we can obtain the per capita (per person) rate which susceptible people are becoming infectious, or the force of infection as follows: <span class="math display">\[
\lambda=cp\tilde{I}
\]</span></p>
</blockquote>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Although this formulation for <span class="math inline">\(\lambda\)</span> is based on first principles, there are still a number of assumptions being made. Namely:</p>
<ol type="1">
<li><p>We assume every individual in the population comes into contact with other individuals at a constant rate <span class="math inline">\(c\)</span>. This means we assume everyone in the population is equally sociable and, on average, comes into contact with the same number of people per unit time.</p></li>
<li><p>We assume <em>homogeneous mixing</em> of the population. That is, we assume everyone has an equal probability of contacting any other individual in the population. In real life, this is of course not true: infectious individuals are more likely to come into contact with other infectious individuals if they go to the hospital and are less likely to come into contact with susceptible individuals if they quarantine, just to name a few examples.</p></li>
</ol>
</div>
</div>
<p>The force of infection is calculated in many ways; we just provide one of many possible formulations and rationales here. Notice there are two constant terms in the formulation for <span class="math inline">\(\lambda\)</span> given above: <span class="math inline">\(c\)</span> and <span class="math inline">\(p\)</span>. Since these terms are constant throughout time in the model, they are grouped together into a singular term, known as the <em>transmission rate</em>. As it is a constant unaffected by the dynamics of the model itself, the transmission rate—often denoted as <span class="math inline">\(\beta\)</span>—is considered a property of the specific disease or pathogen being analyzed and is calculated prior to the construction of the model. We present common methods of calculating <span class="math inline">\(\beta\)</span>, summarized in the table below:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 48%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th><strong>method</strong></th>
<th><strong>What is it?</strong></th>
<th><strong>Best Used When . . .</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Blackbox method</td>
<td>This is a data-driven method wherein <span class="math inline">\(\beta\)</span> is calculated empirically using epidemiological data. We can think of this as “fitting” a value of <span class="math inline">\(\beta\)</span> in our model to most accurately reflect the dynamics we observe in the real world.</td>
<td>There is an abundance of accurate real-world data available on the number of susceptible and infectious people over time.</td>
</tr>
<tr class="even">
<td>First-Principles method</td>
<td>This method utilizes the formulation <span class="math inline">\(\beta=cp\)</span>, which was obtained using first-principles, and separately calculates appropriate values for <span class="math inline">\(c\)</span> and <span class="math inline">\(p\)</span>. The specifics of how <span class="math inline">\(c\)</span> and <span class="math inline">\(p\)</span> are calculated vary widely depending on context and model complexity, but can be found using a combination of logic and predictions for how people will interact as well as real-world data on the transmissibility of a pathogen.</td>
<td>Real-world data is scarcer or there the data available lends itself better to calculating <span class="math inline">\(c\)</span> and <span class="math inline">\(p\)</span> separately rather than fitting an overall <span class="math inline">\(\beta\)</span>.</td>
</tr>
</tbody>
</table>
<p>Putting this all together, we can rewrite the SIR model equations from the <a href="#the-classic-sir-epidemic-model">previous section</a> as follows:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dS}{dt} &amp;= -\beta \tilde{I} S \\[10pt]
\frac{dI}{dt} &amp;= \beta \tilde{I} S - \gamma I \\[10pt]
\frac{dR}{dt} &amp;= \gamma I
\end{aligned}
\]</span></p>
<p>And for proportions:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{d\tilde{S}}{dt} &amp;= -\beta \tilde{I} \tilde{S} \\[10pt]
\frac{d\tilde{I}}{dt} &amp;= \beta \tilde{I} \tilde{S} - \gamma \tilde{I} \\[10pt]
\frac{d\tilde{R}}{dt} &amp;= \gamma \tilde{I}
\end{aligned}
\]</span></p>
<p>CITATION: difficult to say, mixture of book and own intuition of these concepts</p>
</section>
<section id="formulating-the-recovery-rate-and-other-parameters" class="level3">
<h3 class="anchored" data-anchor-id="formulating-the-recovery-rate-and-other-parameters">Formulating the Recovery Rate and Other Parameters</h3>
<p>MLE?</p>
</section>
</section>
<section id="solving-sir-equations" class="level2">
<h2 class="anchored" data-anchor-id="solving-sir-equations">Solving SIR Equations</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Learning Objectives">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this section, you should be able to:</p>
<ul>
<li><p>Solve basic SIR model equations using a combination of mathematical and computational techniques.</p></li>
<li><p>Identify the difference between common methods of solving SIR-type models, including Euler’s method and the deSolve package in R.</p></li>
</ul>
</div>
</div>
<p>Two common methods of solving differential equations that are difficult to solve by hand (in an exact method, that is) is:</p>
<ol type="1">
<li>Euler’s method</li>
<li>The deSolve package in R</li>
</ol>
<p>We will go over each method in this section and the differences between the two.</p>
<section id="eulers-method" class="level3">
<h3 class="anchored" data-anchor-id="eulers-method">Euler’s method</h3>
<p>Euler’s method estimates the solution to a differential equation using a series of short, connected linear approximations at a discrete set of times. Although Euler’s method is widely regarded to be a relatively inefficient method for solving otherwise “unsolvable” (at least in the elementary sense) ordinary differential equations, it is still valued for its simplicity and accessibility.</p>
<p>Suppose we have approximate initial values for the variables of interest (which, in the case of the SIR model, is the number or proportion of susceptible, infectious, and recovered individuals at the beginning of our study period). We will denote the number of susceptible, infectious, and recovered individuals at starting time <span class="math inline">\(t\)</span> as <span class="math inline">\(S(0)\)</span>, <span class="math inline">\(I(0)\)</span>, and <span class="math inline">\(R(0)\)</span>, respectively.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>To keep it simple, we will only discuss the process of Euler’s method as it is applied to the number of individuals in each compartment, but keep in mind this process can be applied in exactly the same way to proportions as well.</p>
</div>
</div>
<p>Our goal is to find an approximate solutions to <span class="math inline">\(S(t)\)</span>, <span class="math inline">\(I(t)\)</span>, and <span class="math inline">\(R(t)\)</span>—the number of individuals in each category at time <span class="math inline">\(t\)</span>—using <span class="math inline">\(s(0)\)</span>, <span class="math inline">\(i(0)\)</span>, and <span class="math inline">\(r(0)\)</span> and the rates of change given by the system of SIR equations formulated in <a href="#the-classic-sir-epidemic-model">this section</a>. For clarity, <span class="math inline">\(S(t)\)</span>, <span class="math inline">\(I(t)\)</span>, and <span class="math inline">\(R(t)\)</span> represent the exact solutions to the SIR equations, and the approximation solutions given by Euler’s method are represent as <span class="math inline">\(s(t)\)</span>, <span class="math inline">\(i(t)\)</span>, and <span class="math inline">\(r(t)\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>These types of problems, one where we are given a set of intial values and corresponding differential equations, are known as initial-value problems (or IVPs).</p>
</div>
</div>
<p>Euler’s method involves repeatedly finding tangent line approximations to <span class="math inline">\(S(t)\)</span>, <span class="math inline">\(I(t)\)</span>, and <span class="math inline">\(R(t)\)</span> at a discrete set of times (often called nodes):</p>
<ul>
<li><span class="math inline">\(s_0,\dots,s_t,\dots,s_b\)</span></li>
<li><span class="math inline">\(i_0,\dots,i_t,\dots,i_b\)</span></li>
<li><span class="math inline">\(r_0,\dots,r_t,\dots,r_b\)</span></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(s_t\)</span>, <span class="math inline">\(i_t\)</span>, and <span class="math inline">\(r_t\)</span> represent approximations to <span class="math inline">\(S(t)\)</span>, <span class="math inline">\(I(t)\)</span>, and <span class="math inline">\(R(t)\)</span> at a time <span class="math inline">\(t\)</span>. Additionally, <span class="math inline">\(s_b\)</span>, <span class="math inline">\(i_b\)</span>, and <span class="math inline">\(r_b\)</span> just represent the approximation at the final time <span class="math inline">\(b\)</span> of the interval we wish to find an approximate solution to, or <span class="math inline">\([0,b]\)</span> .</p>
</div>
</div>
<p>These approximations are found using the following recursive formulas:</p>
<p><span class="math display">\[
\begin{align}
s_{t+1} &amp;= s_t - \Delta t \, \beta i_t s_t \\[10pt]
i_{t+1} &amp;= i_t + \Delta t \, (\beta i_t s_t - \gamma i_t) \\[10pt]
r_{t+1} &amp;= r_t + \Delta t \, \gamma i_t
\end{align}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(s_{t+1}\)</span>, <span class="math inline">\(i_{t+1}\)</span>, and <span class="math inline">\(r_{t+1}\)</span> are the approximations for <span class="math inline">\(S(t)\)</span>, <span class="math inline">\(I(t)\)</span>, and <span class="math inline">\(R(t)\)</span> at the next node</li>
<li><span class="math inline">\(s_{t}\)</span>, <span class="math inline">\(i_{t}\)</span>, and <span class="math inline">\(r_{t}\)</span> are the approximations for <span class="math inline">\(S(t)\)</span>, <span class="math inline">\(I(t)\)</span>, and <span class="math inline">\(R(t)\)</span> at the previous node</li>
<li><span class="math inline">\(\Delta t\)</span> is the step size (how far each node is spaced apart on the <span class="math inline">\(t\)</span>-axis)</li>
<li><span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> are the transmission and recovery rate, respectively</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>This formula is just an application of the generalized Euler’s method for first-order differential equation <span class="math inline">\(Y'(t)=f(t,Y(t))\)</span>, true solution <span class="math inline">\(Y(t)\)</span>, and approximate solutions <span class="math inline">\(y_0,\dots,y_t,\dots,y_b\)</span>, which are calculated at evenly spaced <span class="math inline">\(t_n\)</span> as:</p>
<p><span class="math inline">\(y_{t+1}=y_t+ \Delta t f(t_n,Y(t_n)\)</span></p>
<p>Where again <span class="math inline">\(\Delta t\)</span> is how far each <span class="math inline">\(t_n\)</span> are apart.</p>
<p>Specifically, the formulas provided above substitute the rate of change functions <span class="math inline">\(\frac{dS}{dt}\)</span>, <span class="math inline">\(\frac{dI}{dt}\)</span>, and <span class="math inline">\(\frac{dR}{dt}\)</span> in directly.</p>
</div>
</div>
<p>This process can be a little confusing to grasp at first, so let’s do an example.</p>
<p>Suppose the following SIR model equations with initial values <span class="math inline">\(s(0)=99\)</span>, <span class="math inline">\(i(0)=1\)</span>, <span class="math inline">\(r(0)=0\)</span>, transmission rate <span class="math inline">\(\beta=1.5\)</span>, and recovery rate <span class="math inline">\(\gamma=0.5\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dS}{dt} &amp;= -1.5 \tilde{I} S \\[10pt]
\frac{dI}{dt} &amp;= 1.5 \tilde{I} S - 0.5 I \\[10pt]
\frac{dR}{dt} &amp;= 0.5 I
\end{aligned}
\]</span></p>
<p>The following table illustrates the calculation process until <span class="math inline">\(t=5\)</span> with a step size of <span class="math inline">\(\Delta t=1\)</span>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 34%">
<col style="width: 46%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Time</strong></th>
<th><strong>Approximations</strong></th>
<th><strong>Calculation Process</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(t=0\)</span></td>
<td><span class="math inline">\(s(0)=99.0\)</span><br><span class="math inline">\(i(0)=1.0\)</span><br><span class="math inline">\(r(0)=0.0\)</span></td>
<td>—</td>
</tr>
<tr class="even">
<td><span class="math inline">\(t=1\)</span></td>
<td><span class="math inline">\(s(1)\approx 97.5\)</span><br><span class="math inline">\(i(1)\approx 2.0\)</span><br><span class="math inline">\(r(1)=0.5\)</span></td>
<td><span class="math inline">\(s(1)=99-(1)(1.5)(\frac{1}{100})(99)\)</span><br><span class="math inline">\(i(1)=1+(1)[(1.5)(\frac{1}{100})(99)-0.5(1)]\)</span><br><span class="math inline">\(r(1)=0+(1)(0.5)(1)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(t=2\)</span></td>
<td><span class="math inline">\(s(2)\approx 94.6\)</span><br><span class="math inline">\(i(2)\approx 3.9\)</span><br><span class="math inline">\(r(2)\approx 2.0\)</span></td>
<td><span class="math inline">\(s(2)=97.5-(1)(1.5)(\frac{2.0}{100})(97.5)\)</span><br><span class="math inline">\(i(2)=2.0+(1)[(1.5)(\frac{2.0}{100})(97.5)-0.5(2.0)]\)</span><br><span class="math inline">\(r(2)=0.5+(1)(0.5)(2.0)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(t=3\)</span></td>
<td><span class="math inline">\(s(3)\approx 89.1\)</span><br><span class="math inline">\(i(3)\approx 7.5\)</span><br><span class="math inline">\(r(3)\approx 3.4\)</span></td>
<td><span class="math inline">\(s(3)=94.6-(1)(1.5)(\frac{3.9}{100})(94.6)\)</span><br><span class="math inline">\(i(3)=3.9+(1)[(1.5)(\frac{3.9}{100})(94.6)-0.5(3.9)]\)</span><br><span class="math inline">\(r(3)=2.0+(1)(0.5)(3.9)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(t=4\)</span></td>
<td><span class="math inline">\(s(4)\approx 79.1\)</span><br><span class="math inline">\(i(4)\approx 13.7\)</span><br><span class="math inline">\(r(4)\approx 7.2\)</span></td>
<td><span class="math inline">\(s(4)=89.1-(1)(1.5)(\frac{7.5}{100})(89.1)\)</span><br><span class="math inline">\(i(4)=7.5+(1)[(1.5)(\frac{7.5}{100})(89.1)-0.5(7.5)]\)</span><br><span class="math inline">\(r(4)=3.4+(1)(0.5)(7.5)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(t=5\)</span></td>
<td><span class="math inline">\(s(5)\approx 62.8\)</span><br><span class="math inline">\(i(5)\approx 23.1\)</span><br><span class="math inline">\(r(5)\approx 14.0\)</span></td>
<td><span class="math inline">\(s(5)=79.1-(1)(1.5)(\frac{13.7}{100})(79.1)\)</span><br><span class="math inline">\(i(5)=13.7+(1)[(1.5)(\frac{13.7}{100})(79.1)-0.5(13.7)]\)</span><br><span class="math inline">\(r(5)=7.2+(1)(0.5)(13.7)\)</span></td>
</tr>
</tbody>
</table>
<p>As you might notice, the calculations above are very tedious, which is why Euler’s method is most often calculated using code rather than by hand.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Note">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The accuracy of the solution produced by Euler’s method is a direct result of what we choose the step size to be. If the step size is larger, then the curvature of the true solution will be lost since we are repeatedly taking linear approximations, resulting in an approximate solution that deviates a lot from the true solution curve. On the other hand, as the step size gets smaller, the approximate solution provided by Euler’s method converges to the true solution curve.</p>
<p>See the section <a href="#evaluating-and-comparing-both-methods">Evaluating and Comparing Both Methods</a> for a simulation demonstrating what happens when you change the step size.</p>
</div>
</div>
<p>CITATION: https://homepage.math.uiowa.edu/~atkinson/papers/NAODE_Book.pdf</p>
</section>
<section id="desolve-package-in-r" class="level3">
<h3 class="anchored" data-anchor-id="desolve-package-in-r">deSolve Package in R</h3>
<p>The deSolve Package in R contains a variety of functions that “solve initial value problems of a system of first-order ordinary differential equations (‘ODE’), of partial differential equations (‘PDE’), of differential algebraic equations (‘DAE’), and of delay differential equations.”</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The SIR-type models we are going to cover deal with systems of first-order ordinary differential equations.</p>
<p>Breaking up each word in this description, we have:</p>
<ul>
<li><p>“First-order”: This just means we are only dealing with equations involving the first derivative and not subsequent derivatives (the second, third, fourth, etc. derivative)</p></li>
<li><p>“Ordinary”: The unknown function which we are trying to solve for depends only one independent variable.</p></li>
</ul>
</div>
</div>
<p>Since our applications will only deal with first-order ODEs, we will only cover the deSolve function <code>ode</code>, which is used to solve (as you can probably guess) initial value problems (IVPs) for first-order ordinary differential equations.</p>
<p>The function <code>ode</code> takes in the following relevant parameters, summarized in the table below:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Parameter Name</strong></th>
<th><strong>What Does It Take In?</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>func</code></td>
<td>A user-defined function that defines and returns a list of the model equations (the differential equations to be solved).</td>
</tr>
<tr class="even">
<td><code>y</code></td>
<td>A vector specifying initial values.</td>
</tr>
<tr class="odd">
<td><code>parms</code></td>
<td>A vector specifying the model parameters.</td>
</tr>
<tr class="even">
<td><code>times</code></td>
<td>A vector specifying the time points at which the solution of the model equations should be returned. This determines the resolution of the overall output but not the numerical accuracy of each output point.</td>
</tr>
</tbody>
</table>
<p>The function <code>ode</code> returns a matrix whose first column is the time points specified in the input <code>times</code> and subsequent columns are the solutions to the model’s state variables at those times. The state variables for an SIR model are the number or proportion of individuals susceptible, infected, and recovered at a given time.</p>
<p>Before we can call <code>ode</code>, we must code the function to be passed into the parameter <code>func</code>. For a classic SIR model on the proportion of individuals in each compartment (see <a href="#the-classic-sir-epidemic-model">The Classic SIR Epidemic Model</a> we do this using the following template function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>ModelFunc <span class="ot">&lt;-</span> <span class="cf">function</span>(time,state,parameters){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extracting the state variables</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Since we are doing this in the context of SIR models, we have the state variables S, I, and R</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">&lt;-</span> state[<span class="st">"S"</span>]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  I <span class="ot">&lt;-</span> state[<span class="st">"I"</span>]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">&lt;-</span> state[<span class="st">"R"</span>]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extracting the model parameters</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Again, we are doing this for an SIR model, so we have two parameters - the transmission and recovery rate</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> parameters[<span class="st">"beta"</span>]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> parameters[<span class="st">"gamma"</span>]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now we are going to use those previously extracted state variables and parameters to construct our model equations (differential equations)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  dS <span class="ot">&lt;-</span> <span class="sc">-</span>(beta<span class="sc">*</span>I<span class="sc">*</span>S)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  dI <span class="ot">&lt;-</span> (beta<span class="sc">*</span>I<span class="sc">*</span>S) <span class="sc">-</span> (gamma<span class="sc">*</span>I)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  dR <span class="ot">&lt;-</span> (gamma<span class="sc">*</span>I)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now we will return those model equations as a list</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="fu">c</span>(dS,dI,dR)))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now all we need to do is specify the other parameters <code>y</code>, <code>parms</code>, and <code>times</code> and call <code>ode</code> with them like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(deSolve)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we are specifying the initial values to be passed into the parameter y</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure these initial values line up exactly with the state variables extracted in the model function from before</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>initial_vals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">S=</span><span class="fl">0.99</span>,<span class="at">I=</span><span class="fl">0.01</span>,<span class="at">R=</span><span class="dv">0</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we are specifying the parameters of the model and their values</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure these parameters line up exactly with the parameters extracted in the model function from before</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">beta=</span><span class="fl">1.5</span>,<span class="at">gamma=</span><span class="fl">0.5</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we are specifying the times for which outputs are calculated</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># The closer together these times are, the higher the output resolution</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>output_times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we can call the function ode like so:</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">ode</span>(<span class="at">func=</span>ModelFunc,<span class="at">y=</span>initial_vals,<span class="at">parms=</span>model_parameters,<span class="at">times=</span>output_times)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing the first 5 rows of the output matrix</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(output,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     time         S          I           R
[1,]    0 0.9900000 0.01000000 0.000000000
[2,]    1 0.9651705 0.02636257 0.008466945
[3,]    2 0.9044949 0.06539460 0.030110501
[4,]    3 0.7783227 0.14148790 0.080189448
[5,]    4 0.5844537 0.23987018 0.175676172</code></pre>
</div>
</div>
<p>Now that we have this matrix of the solved SIR model equations are at specified times, we can plot it like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x =</span> output[,<span class="st">"time"</span>], <span class="at">y =</span> output[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">xlab =</span> <span class="st">"time"</span>, <span class="at">ylab =</span> <span class="st">"proportion"</span>, <span class="at">main =</span> <span class="st">"Solved Example SIR Model"</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>,<span class="st">"green"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a legend</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Susceptible"</span>, <span class="st">"Infectious"</span>, <span class="st">"Recovered"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>,<span class="st">"green"</span>), <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SIR_Module_RD_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>CITATION FOR QUOTE: https://cran.r-project.org/web/packages/deSolve/index.html</p>
<p>CITATION FOR CONTENT: file:///C:/Users/anjal/Downloads/v33i09.pdf</p>
</section>
<section id="evaluating-and-comparing-both-methods" class="level3">
<h3 class="anchored" data-anchor-id="evaluating-and-comparing-both-methods">Evaluating and Comparing Both Methods</h3>
<p>The following table summarizes some potential benefits and drawbacks to using Euler’s method or deSolve:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 5%">
<col style="width: 38%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Solving Method</strong></th>
<th><strong>Potential Benefits</strong></th>
<th><strong>Potential Drawbacks</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Euler’s Method</td>
<td>- Can be done by hand or implemented in code<br>- Simple to understand<br>- Full control over accuracy of model <br>- No external packages required</td>
<td>- Low accuracy unless an extremely small step size is used<br>- Computationally inefficient for small step sizes or complex models<br>- Can be tedious to calculate by hand</td>
</tr>
<tr class="even">
<td>deSolve Package</td>
<td>- Uses advanced solving methods with high accuracy<br>- Handles large models with many system equations well<br>- Efficient for complex models</td>
<td>- Less transparent approach; not much understanding of what is going on “under the hood”<br>- Requires learning new functions and syntax<br>- Depends on external packages<br>- Less control over solving method and accuracy</td>
</tr>
</tbody>
</table>
<p>The following simulation shows the difference between the solution curves produced by Euler’s method and the deSolve package for different values of the model parameters and step size:</p>
<p>INSERT SHINY APP HERE</p>
</section>
</section>
<section id="reproduction-numbers" class="level2">
<h2 class="anchored" data-anchor-id="reproduction-numbers">Reproduction Numbers</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Learning Objectives">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this section, you should be able to:</p>
<ul>
<li><p>Define what the basic and effective reproduction number is and recall primary differences between the two.</p></li>
<li><p>Interpret the basic and effective reproduction number in context.</p></li>
<li><p>Derive the formula for the basic and effective reproduction numbers based on their definitions.</p></li>
</ul>
</div>
</div>
<section id="the-basic-reproduction-number" class="level3">
<h3 class="anchored" data-anchor-id="the-basic-reproduction-number">The Basic Reproduction Number</h3>
</section>
</section>
<section id="example-of-the-classic-epidemic-model" class="level2">
<h2 class="anchored" data-anchor-id="example-of-the-classic-epidemic-model">Example of the Classic Epidemic Model</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Learning Objectives">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this section, you should be able to:</p>
<ul>
<li>Identify examples of situations where the classic epidemic model is a useful tool for modeling.</li>
</ul>
</div>
</div>
</section>
<section id="the-classic-endemic-model" class="level2">
<h2 class="anchored" data-anchor-id="the-classic-endemic-model">The Classic Endemic Model</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Learning Objectives">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this section, you should be able to:</p>
<ul>
<li><p>Recall the classic endemic model’s equations.</p></li>
<li><p>Differentiate the classic endemic model from the epidemic model.</p></li>
</ul>
</div>
</div>
</section>
<section id="disease-free-and-endemic-equilibrium" class="level2">
<h2 class="anchored" data-anchor-id="disease-free-and-endemic-equilibrium">Disease Free and Endemic Equilibrium</h2>
<div class="callout callout-style-default callout-tip callout-titled" title="Learning Objectives">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>By the end of this section, you should be able to:</p>
<ul>
<li><p>Define what an equilibrium is the context of a system of differential equations.</p></li>
<li><p>Find the values where the disease-free and endemic equilibrium occur.</p></li>
<li><p>Recall when each equilibrium type occurs in relation to R0 and justify it based on the definition of R0.</p></li>
</ul>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>