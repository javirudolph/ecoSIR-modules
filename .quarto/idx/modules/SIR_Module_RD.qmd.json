{"title":"SIR Module Rough Draft","markdown":{"yaml":{"title":"SIR Module Rough Draft","format":{"html":{"toc":true,"toc-location":"right"}},"editor":"visual","bibliography":"../reference.bib"},"headingText":"Introduction and Course Learning Objectives","containsRefs":false,"markdown":"\n\n\n\n```{r}\nsystem(\"Rscript ./run_app_script.R &\")\nSys.sleep(5)\n```\n\n\n## Epidemiology Terms\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Define basic terms in epidemiology.\n:::\n\nFor the purposes of mathematical models in epidemiology, such as the SIR model, individuals are classified based solely on their ability to transmit a pathogen, not their diseased status (whether or not they exhibit symptoms). For the purposes of epidemiological models, individuals are generally classified into four primary categories:\n\n-   **Susceptible:** No pathogen is present in the individual. The individual only has a low level of non-specific immunity to incoming infection.\n\n-   **Exposed:** The individual has encountered an infected individual and is infected with the pathogen. The levels of pathogen in this individual are too low to allow them to transmit the disease to another person. This individual is hence considered \"exposed\" to the pathogen but not yet able to infect others with it.\n\n-   **Infectious:** The individual has surpassed the exposed stage and the pathogen levels within them are high enough to allow for transmission. This individual is no longer just exposed to the pathogen, but can actively spread it now.\n\n-   **Recovered:** The individual has surpassed the infectious stage, their immune system has cleared enough of the pathogen that they can no longer transmit it. This individual has some amount of immunity to the pathogen now, but for how long this immunity lasts depends on the specific pathogen.\n\n::: {.callout-note}\nThe individual can still exhibit symptoms of the disease while in the recovered compartment, so it is best to think of this compartment as individuals who have \"recovered\" from their ability to spread the infection but not necessarily all symptomatic implications of that infection.\n:::\n\nThese categories are not exhaustive, and individuals can be classified into further categories based on their stage of infection or immunity status, just to name a few. These four categories are highlighted since they come up most often while discussing SIR-type models and epidemiological models in general. It is important to note that, at the same time individuals fall into these categories, they can also be classified based on whether or not they exhibit symptoms of infection:\n\n-   **Incubation Period:** The individual has been infected with the pathogen but does not show disease symptoms. This is also commonly refferred to as the *asymptomatic period*.\n\n-   **Diseased period:** The individual has surpassed the incubation period and begins to show symptoms of the disease.\n\nAlthough these classifications are more commonly used in a medical, rather than an epidemiological, contexts, we still provide them here to clarify the fact that an individual can still be infectious while in the incubation period and showing no symptoms of the disease. Similarly, an individual can still be in the diseased period and show lingering symptoms of infection while being recovered since their immune system has cleared enough of the pathogen that they are not longer infectious.\n\n(PLACE GRAPH HERE OF ALL THESE PERIODS)\n\n**Section References**\n\n@keeling_modeling_2008\n\n## Introducing Compartmental Models {#introducing-compartmental-models}\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Define what a compartmental model is.\n-   Identify which differential equation models can be called compartmental models.\n:::\n\nGenerally speaking, compartmental models are a way to represent the flow of populations between different states, known as compartments, using differential equations. Compartmental models show up in a wide variety of fields, not just epidemiology. Any field that can benefit from knowing how information flows between states can benefit from compartmental models.\n\nIn the epidemiological context, compartmental models are analyzing how people flow through the four categories, which will be referred to simply as \"compartments\" from now on, introduced in the previous section: susceptible, exposed, infectious, and recovered. The relationships between these compartments are often represented using flowcharts like the one seen below.\n\n(INSERT IMAGE OF SEIR FLOWCHART THAT SPECIFICALLY SHOWS LAMBDA INSTEAD OF BETA AS THE FLOW RATE BETWEEN S AND E)\n\nThe arrows between these compartments represent the direction of flow (susceptible individuals becoming exposed, exposed individuals becoming infectious, etc.) and the symbols above each arrow represent the *flow rate* between these compartments with respect to time.\n\nIt's easiest to understand this conceptually through an example. Say in a very large population with the established presence of a pathogen, on average, 300 new people become exposed to a pathogen every day. Of those that are exposed to the pathogen, on average, 50 of them reach pathogen levels high enough to become infectious per day. Then, of those that are infectious and able to transmit the pathogen, on average, 40 of them recover from the pathogen (in the sense that they can no longer transmit it). We can model this specific example with the modified flowchart below:\n\nWhich compartments we choose to include depends on the specific pathogen and disease we are modeling. Models where the exposed period is so small it can be considered negligible, or is ommited for the sake of simplicity, are specifically known as *SIR models* (standing for the three different compartments included in the model: susceptible, infectious, and recovered).\n\n::: {.callout-note}\nSome sources will refer generally to any compartmental epidemiological model as an \"SIR model,\" but in our context we will make the distinction between SIR models and models that include different compartments than just susceptible, infectious, and recovered.\n\nWe will, however, refer to the general idea of compartmental epidemiological models as \"SIR-type models.\"\n:::\n\nThe [next section](#the-classic-sir-epidemic-model) covers the specific formulation and assumptions of this model.\n\n### Learning Assessment:\n\nMake assessment that's like given what compartments these letters represent draw a flowchart for the following models like SEIR SMEIR SIS SIRS etc\n\n**Section References**\n\n@keeling_modeling_2008\n\n## The Classic SIR Epidemic Model {#the-classic-sir-epidemic-model}\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Recall the classic epidemic model's equations.\n\n-   Construct equations for novel compartmental models given the flow rates between each of the compartments.\n\n-   Identify the assumptions (and their justifications) made in the formulation of the classic epidemic model, including the assumptions made in relation to how its parameters were obtained / formulated.\n\n-   Recall what parameters go into the construction of the classic epidemic model, including the typical symbols for each.\n\n-   Explain how the classic epidemic model deviates from reality in relation to the assumptions it makes.\n\n-   Differentiate situations where an empirically deduced transmission rate is more accurate and beneficial to one calculated based on first principles.\n\n-   Discern what situations are best modeled by frequency or density dependent transmission rates, or a combination of both.\n:::\n\nThe classic SIR epidemic model is a type of compartmental model that makes the following key assumptions:\n\n1.  The epidemic invades the population and concludes itself quickly enough that demographic processes, namely births and deaths, are not very influential to the overall process and can be omitted from the model. This is also known as the *closed population* assumption.\n\n2.  Individuals move between the compartments of susceptible, infectious, and recovered only. Other compartments, namely the exposed compartment, are omitted for simplicity.\n\n::: {.callout-note}\nSince this module covers only the epidemic and endemic SIR models, neither of which include the exposed compartment, the terms \"infected\" and \"infectious\" will be used interchangeably moving forward. This is because with only the susceptible, infectious, and recovered compartments, once an individual gets infected with the pathogen we assume they are infectious as well.\n\nIt is important to note that although \"infected\" and \"infectious\" are used interchangeably within the context of this learning module, they are not synonymous all the time. As model complexity increases and the exposed compartment is included, a distinction must be made between the two, as an individual can be considered \"infected\" but not \"infectious\" (i.e. they belong to the exposed compartment).\n:::\n\nThese are not the only assumptions made by the epidemic SIR model, but they do clearly distinguish it from other compartmental models such as the SEIR model, which includes exposed compartment, and the endemic SIR model, which includes the flow in and out of each compartment due to demographics (births and death).\n\nMoving forward, $S$. $I$, and $R$ will refer to the *number* of individuals in the susceptible, infectious, and recovered compartments, respectively. The variables $\\tilde{S}=\\frac{S}{N}$, $\\tilde{I}=\\frac{I}{N}$, and $\\tilde{R}=\\frac{R}{N}$, will be used to refer to the *proportion* of individuals in the susceptible, infectious, and recovered compartments, respectively, where $N$ is the total number of individuals in the population defined as $N=S+I+R$.\n\n::: {.callout-note}\n-   Since the epidemic model assumes a closed population with no births or deaths, $N$ is not a variable that can change but a constant.\n\n-   Notice that $\\tilde{S}+\\tilde{I}+\\tilde{R}=1$\n:::\n\nThe following equations provide the rates of change, with respect to time, for the number of individuals in each of the three compartments of the epidemic SIR model:\n\n$$\n\\begin{aligned}\n\\frac{dS}{dt} &= -\\lambda S \\\\[10pt]\n\\frac{dI}{dt} &= \\lambda S - \\gamma I \\\\[10pt]\n\\frac{dR}{dt} &= \\gamma I\n\\end{aligned}\n$$\n\nDividing each equation by the population size $N$, we can rewrite the SIR equations above to provide the rates of change, with respect to time, for the proportion of individuals in each compartment:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt} &= -\\lambda \\tilde{S} \\\\[10pt]\n\\frac{d\\tilde{I}}{dt} &= \\lambda \\tilde{S} - \\gamma \\tilde{I} \\\\[10pt]\n\\frac{d\\tilde{R}}{dt} &= \\gamma \\tilde{I}\n\\end{aligned}\n$$\n\n::: {.callout-note}\nThe rate of change of the number of people in each compartment can be understood as following the basic pattern of $R_i-R_o$ where $R_i$ is the rate that people are flowing into the compartment per unit time and $R_o$ is the rate that people are flowing out of the compartment per unit time. This pattern can be used to construct any number of novel compartmental models.\n:::\n\nNotice that these equations mirror exactly the compartmental flowcharts introduced in the [previous section](#introducing-compartmental-models). The epidemic SIR model can be representing using the following flowchart:\n\nThe flow rates between each compartment have specific names and symbology, summarized in the table below:\n\n| **Terminology / Name** | **Common Symbol** | **Interpretation** |\n|-------------------|------------------|-----------------------------------|\n| Force of Infection | $\\lambda$ | The per capita rate at which susceptible individuals are becoming infectious per unit time. |\n| Recovery Rate | $\\gamma$ | The per capita rate at which infectious individuals are recovering from infection per unit time. |\n\n::: {.callout-note}\nThe phrase \"per capita\" here refers to a rate that is divided among each person in the given compartment. Take the following example: if 3 people are pouring water into a large bucket and each are adding 5 cups per minute, then the per capita rate at which water is being added is 5 cups per minute. To obtain the total rate at which water is being poured into the bucket, we would multiply the number of people pouring, 3, by their per capita rate, 5, to get a total inflow of 15 cups per minute.\n\nA similar logic is being utilized in the SIR equations: the number of susceptible people at a given time, $S$, is multiplied by the per capita rate they are becoming infectious to get the total rate at which people are entering the infectious compartment Similarly, the number of infectious people at a given time, $I$, is multiplied by the per capita rate they are recovering to get the total rate at which people are entering the recovered compartment\n:::\n\n**Section References**\n\n@keeling_modeling_2008\n\n### Formulating the Force of Infection\n\nThe force of infection, or the rate at which susceptible individuals are becoming infected per unit time, can be understood and formulated based on first principles in epidemiology as follows:\n\n> Consider the perspective of a susceptible individual in the population at any given time. Let's say this individual makes, on average, $c$ contacts with other people per unit time. Then, suppose that of those $c$ people this individual makes contact with per unit time, the proportion of them that will be infectious is $\\tilde{I}$. Then, of those $c\\tilde{I}$ contacts this individual makes with infectious people, the proportion of them that will actually succeed at spreading the infection to them is $p$. Multiplying these together, we can obtain the per capita (per person) rate which susceptible people are becoming infectious, or the force of infection as follows: $$\n> \\lambda=cp\\tilde{I}\n> $$\n\n::: {.callout-note}\nAlthough this formulation for $\\lambda$ is based on first principles, there are still a number of assumptions being made. Namely:\n\n1.  We assume every individual in the population comes into contact with other individuals at a constant rate $c$. This means we assume everyone in the population is equally sociable and, on average, comes into contact with the same number of people per unit time.\n\n2.  We assume *homogeneous mixing* of the population. That is, we assume everyone has an equal probability of contacting any other individual in the population. In real life, this is of course not true: infectious individuals are more likely to come into contact with other infectious individuals if they go to the hospital and are less likely to come into contact with susceptible individuals if they quarantine, just to name a few examples.\n:::\n\nThe force of infection is calculated in many ways; we just provide one of many possible formulations and rationales here. Notice there are two constant terms in the formulation for $\\lambda$ given above: $c$ and $p$. Since these terms are independent of the number of individuals in each compartment throughout time, they are grouped together into a singular term, known as the *transmission rate*. As it is generally unaffected by the dynamics of the model itself, the transmission rate---often denoted as $\\beta$---is considered a property of the specific disease or pathogen being analyzed and is formulated prior to the construction of the model.\n\nPutting this all together, we can rewrite the SIR model equations from the [previous section](#the-classic-sir-epidemic-model) as follows:\n\n$$\n\\begin{aligned}\n\\frac{dS}{dt} &= -\\beta \\tilde{I} S \\\\[10pt]\n\\frac{dI}{dt} &= \\beta \\tilde{I} S - \\gamma I \\\\[10pt]\n\\frac{dR}{dt} &= \\gamma I\n\\end{aligned}\n$$\n\nAnd for proportions:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt} &= -\\beta \\tilde{I} \\tilde{S} \\\\[10pt]\n\\frac{d\\tilde{I}}{dt} &= \\beta \\tilde{I} \\tilde{S} - \\gamma \\tilde{I} \\\\[10pt]\n\\frac{d\\tilde{R}}{dt} &= \\gamma \\tilde{I}\n\\end{aligned}\n$$\n\nNow comes the question of how we even find $\\beta$? The table below presents two common methods for calculating $\\beta$:\n\n| **Method** | **What is it?** | **Best Used When . . .** |\n|------------------|----------------------------------|---------------------|\n| Blackbox method | This is a data-driven method wherein $\\beta$ is calculated empirically using epidemiological data. We can think of this as \"fitting\" a value of $\\beta$ in our model to most accurately reflect the dynamics we observe in the real world. | There is an abundance of accurate real-world data available on the number of susceptible and infectious people over time. |\n| First-Principles method | This method utilizes the formulation $\\beta=cp$, which was obtained using first-principles, and separately calculates appropriate values for $c$ and $p$. | Real-world data is scarcer or there the data available lends itself better to calculating $c$ and $p$ separately rather than fitting an overall $\\beta$. |\n\n\nFor the purposes and scope of this introductory module, we will only provide examples and insights into the blackbox method for calculating the transmission rate $\\beta$. This is because specifics of how $c$ and $p$ are calculated using the first-principles method depends heavily on model context and complexity, meaning there is no \"one size fits all\" way of finding $\\beta$ using this method. \n\nModels will often formulate $c$ and $p$ as functions of their own depending on a number of external variables. An example of this can be found in this paper [@deer_covid], where the transmission rate $\\beta$ is formulated as the product of the proximity rate $\\omega_{ij}$, or \"frequency per day that host $i$ and recipient $j$ are within 1.5 meters (m) of each other\" and $\\sigma^{Aero}$, or the \"probability of infection from aerosols.\" The paper further decomposes $\\omega_{ij}$ and $\\sigma^{Aero}$ into functions of their own depending on a variety of external variables. \n\nThe specific formulations for the contact rate (or proximity rate) and infection probability utilized by this paper are unique to its context (the pathogen it is analyzing, the host population(s), etc.) and will vary widely from paper to paper. PROVIDE CITATIONS FOR MORE EXAMPLES OF DIFFERENT BETA CALCULATIONS HERE. \n\n\nHowever, there are standardized procedures to obtain $\\beta$ using the blackbox approach, of which one common method known as *maximum likelihood estimation* is covered in the next section.\n\nCITATION: difficult to say, mixture of Keeling / Rohani book and own intuition of these concepts\n\n### Formulating the Transmission Rate, Recovery Rate, and Other Parameters\n\nhttps://scholarworks.lib.csusb.edu/cgi/viewcontent.cgi?article=2232&context=etd\n\nThe paper linked above is a great intro-SIR paper in general and motivates the formulation of the recovery rate as 1 over the average duration of infection. \n\n## Solving SIR Equations\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Solve basic SIR model equations using a combination of mathematical and computational techniques.\n\n-   Identify the difference between common methods of solving SIR-type models, including Euler's method and the deSolve package in R.\n:::\n\nTwo common methods of solving differential equations that are difficult to solve by hand (in an exact method, that is) is:\n\n1.  Euler's method\n2.  The deSolve package in R\n\nWe will go over each method in this section and the differences between the two.\n\n### Euler's method\n\nEuler's method estimates the solution to a differential equation using a series of short, connected linear approximations at a discrete set of times. Although Euler's method is widely regarded to be a relatively inefficient method for solving otherwise \"unsolvable\" (at least in the elementary sense) ordinary differential equations, it is still valued for its simplicity and accessibility.\n\nSuppose we have approximate initial values for the variables of interest (which, in the case of the SIR model, is the number or proportion of susceptible, infectious, and recovered individuals at the beginning of our study period). We will denote the number of susceptible, infectious, and recovered individuals at starting time $t$ as $S(0)$, $I(0)$, and $R(0)$, respectively.\n\n::: {.callout-note}\nTo keep it simple, we will only discuss the process of Euler's method as it is applied to the number of individuals in each compartment, but keep in mind this process can be applied in exactly the same way to proportions as well.\n:::\n\nOur goal is to find an approximate solutions to $S(t)$, $I(t)$, and $R(t)$---the number of individuals in each compartment at time $t$---using $s(0)$, $i(0)$, and $r(0)$ and the rates of change given by the system of SIR equations formulated in [this section](#the-classic-sir-epidemic-model). For clarity, $S(t)$, $I(t)$, and $R(t)$ represent the exact solutions to the SIR equations, and the approximation solutions given by Euler's method are represent as $s(t)$, $i(t)$, and $r(t)$.\n\n::: {.callout-note}\nThese types of problems, one where we are given a set of intial values and corresponding differential equations, are known as initial-value problems (or IVPs).\n:::\n\nEuler's method involves repeatedly finding tangent line approximations to $S(t)$, $I(t)$, and $R(t)$ at a discrete set of times (often called nodes):\n\n-   $s_0,\\dots,s_t,\\dots,s_b$\n-   $i_0,\\dots,i_t,\\dots,i_b$\n-   $r_0,\\dots,r_t,\\dots,r_b$\n\n::: {.callout-note}\n$s_t$, $i_t$, and $r_t$ represent approximations to $S(t)$, $I(t)$, and $R(t)$ at a time $t$. Additionally, $s_b$, $i_b$, and $r_b$ just represent the approximation at the final time $b$ of the interval we wish to find an approximate solution to, or $[0,b]$ .\n:::\n\nThese approximations are found using the following recursive formulas:\n\n$$\n\\begin{aligned}\ns_{t+1} &= s_t - \\Delta t \\, \\beta i_t s_t \\\\[10pt]\ni_{t+1} &= i_t + \\Delta t \\, (\\beta i_t s_t - \\gamma i_t) \\\\[10pt]\nr_{t+1} &= r_t + \\Delta t \\, \\gamma i_t\n\\end{aligned}\n$$\n\nWhere:\n\n-   $s_{t+1}$, $i_{t+1}$, and $r_{t+1}$ are the approximations for $S(t)$, $I(t)$, and $R(t)$ at the next node\n-   $s_{t}$, $i_{t}$, and $r_{t}$ are the approximations for $S(t)$, $I(t)$, and $R(t)$ at the previous node\n-   $\\Delta t$ is the step size (how far each node is spaced apart on the $t$-axis)\n-   $\\beta$ and $\\gamma$ are the transmission and recovery rate, respectively\n\n::: {.callout-note}\nThis formula is just an application of the generalized Euler's method for first-order differential equation $Y'(t)=f(t,Y(t))$, true solution $Y(t)$, and approximate solutions $y_0,\\dots,y_t,\\dots,y_b$, which are calculated at evenly spaced $t_n$ as:\n\n$y_{t+1}=y_t+ \\Delta t f(t_n,Y(t_n)$\n\nWhere again $\\Delta t$ is how far each $t_n$ are apart.\n\nSpecifically, the formulas provided above substitute the rate of change functions $\\frac{dS}{dt}$, $\\frac{dI}{dt}$, and $\\frac{dR}{dt}$ in directly.\n:::\n\nThis process can be a little confusing to grasp at first, so let's do an example.\n\nSuppose the following SIR model equations with initial values $s(0)=99$, $i(0)=1$, $r(0)=0$, transmission rate $\\beta=1.5$, and recovery rate $\\gamma=0.5$:\n\n$$\n\\begin{aligned}\n\\frac{dS}{dt} &= -1.5 \\tilde{I} S \\\\[10pt]\n\\frac{dI}{dt} &= 1.5 \\tilde{I} S - 0.5 I \\\\[10pt]\n\\frac{dR}{dt} &= 0.5 I\n\\end{aligned}\n$$\n\nThe following table illustrates the calculation process until $t=5$ with a step size of $\\Delta t=1$:\n\n| **Time** | **Approximations** | **Calculation Process** |\n|-----------------|------------------------|-------------------------------|\n| $t=0$ | $s\\left(0\\right)=99.0$<br>$i\\left(0\\right)=1.0$<br>$r\\left(0\\right)=0.0$ | — |\n| $t=1$ | $s\\left(1\\right)\\approx 97.5$<br>$i\\left(1\\right)\\approx 2.0$<br>$r\\left(1\\right)=0.5$ | $s\\left(1\\right)=99-\\left(1\\right)\\left(1.5\\right)\\left(\\frac{1}{100}\\right)\\left(99\\right)$<br>$i\\left(1\\right)=1+\\left(1\\right)\\left[\\left(1.5\\right)\\left(\\frac{1}{100}\\right)\\left(99\\right)-0.5\\left(1\\right)\\right]$<br>$r\\left(1\\right)=0+\\left(1\\right)\\left(0.5\\right)\\left(1\\right)$ |\n| $t=2$ | $s\\left(2\\right)\\approx 94.6$<br>$i\\left(2\\right)\\approx 3.9$<br>$r\\left(2\\right)\\approx 2.0$ | $s\\left(2\\right)=97.5-\\left(1\\right)\\left(1.5\\right)\\left(\\frac{2.0}{100}\\right)\\left(97.5\\right)$<br>$i\\left(2\\right)=2.0+\\left(1\\right)\\left[\\left(1.5\\right)\\left(\\frac{2.0}{100}\\right)\\left(97.5\\right)-0.5\\left(2.0\\right)\\right]$<br>$r\\left(2\\right)=0.5+\\left(1\\right)\\left(0.5\\right)\\left(2.0\\right)$ |\n| $t=3$ | $s\\left(3\\right)\\approx 89.1$<br>$i\\left(3\\right)\\approx 7.5$<br>$r\\left(3\\right)\\approx 3.4$ | $s\\left(3\\right)=94.6-\\left(1\\right)\\left(1.5\\right)\\left(\\frac{3.9}{100}\\right)\\left(94.6\\right)$<br>$i\\left(3\\right)=3.9+\\left(1\\right)\\left[\\left(1.5\\right)\\left(\\frac{3.9}{100}\\right)\\left(94.6\\right)-0.5\\left(3.9\\right)\\right]$<br>$r\\left(3\\right)=2.0+\\left(1\\right)\\left(0.5\\right)\\left(3.9\\right)$ |\n| $t=4$ | $s\\left(4\\right)\\approx 79.1$<br>$i\\left(4\\right)\\approx 13.7$<br>$r\\left(4\\right)\\approx 7.2$ | $s\\left(4\\right)=89.1-\\left(1\\right)\\left(1.5\\right)\\left(\\frac{7.5}{100}\\right)\\left(89.1\\right)$<br>$i\\left(4\\right)=7.5+\\left(1\\right)\\left[\\left(1.5\\right)\\left(\\frac{7.5}{100}\\right)\\left(89.1\\right)-0.5\\left(7.5\\right)\\right]$<br>$r\\left(4\\right)=3.4+\\left(1\\right)\\left(0.5\\right)\\left(7.5\\right)$ |\n| $t=5$ | $s\\left(5\\right)\\approx 62.8$<br>$i\\left(5\\right)\\approx 23.1$<br>$r\\left(5\\right)\\approx 14.0$ | $s\\left(5\\right)=79.1-\\left(1\\right)\\left(1.5\\right)\\left(\\frac{13.7}{100}\\right)\\left(79.1\\right)$<br>$i\\left(5\\right)=13.7+\\left(1\\right)\\left[\\left(1.5\\right)\\left(\\frac{13.7}{100}\\right)\\left(79.1\\right)-0.5\\left(13.7\\right)\\right]$<br>$r\\left(5\\right)=7.2+\\left(1\\right)\\left(0.5\\right)\\left(13.7\\right)$ |\n\n\nAs you might notice, the calculations above are very tedious, which is why Euler's method is most often calculated using code rather than by hand.\n\n::: {.callout-tip title=\"Note\"}\nThe accuracy of the solution produced by Euler's method is a direct result of what we choose the step size to be. If the step size is larger, then the curvature of the true solution will be lost since we are repeatedly taking linear approximations, resulting in an approximate solution that deviates a lot from the true solution curve. On the other hand, as the step size gets smaller, the approximate solution provided by Euler's method converges to the true solution curve.\n\nSee the section [Evaluating and Comparing Both Methods](#evaluating-and-comparing-both-methods) for a simulation demonstrating what happens when you change the step size.\n:::\n\n**Section References**\n\n@ode_book\n\n### deSolve Package in R\n\nThe deSolve Package in R contains a variety of functions that \"solve initial value problems of a system of first-order ordinary differential equations ('ODE'), of partial differential equations ('PDE'), of differential algebraic equations ('DAE'), and of delay differential equations\" [@cran_desolve]\n\n::: {.callout-note}\nThe SIR-type models we are going to cover deal with systems of first-order ordinary differential equations.\n\nBreaking up each word in this description, we have:\n\n-   \"First-order\": This just means we are only dealing with equations involving the first derivative and not subsequent derivatives (the second, third, fourth, etc. derivative)\n\n-   \"Ordinary\": The unknown function which we are trying to solve for depends only one independent variable.\n:::\n\nSince our applications will only deal with first-order ODEs, we will only cover the deSolve function `ode`, which is used to solve (as you can probably guess) initial value problems (IVPs) for first-order ordinary differential equations.\n\nThe function `ode` takes in the following relevant parameters, summarized in the table below:\n\n| **Parameter Name** | **What Does It Take In?** |\n|-------------|-----------------------------------------------------------|\n| `func` | A user-defined function that defines and returns a list of the model equations (the differential equations to be solved). |\n| `y` | A vector specifying initial values. |\n| `parms` | A vector specifying the model parameters. |\n| `times` | A vector specifying the time points at which the solution of the model equations should be returned. This determines the resolution of the overall output but not the numerical accuracy of each output point. |\n\nThe function `ode` returns a matrix whose first column is the time points specified in the input `times` and subsequent columns are the solutions to the model's state variables at those times. The state variables for an SIR model are the number or proportion of individuals susceptible, infectious, and recovered at a given time.\n\nBefore we can call `ode`, we must code the function to be passed into the parameter `func`. For a classic SIR model on the proportion of individuals in each compartment (see [The Classic SIR Epidemic Model](#the-classic-sir-epidemic-model) we do this using the following template function:\n\n```{r}\nModelFunc <- function(time,state,parameters){\n  # Extracting the state variables\n  # Since we are doing this in the context of SIR models, we have the state variables S, I, and R\n  S <- state[\"S\"]\n  I <- state[\"I\"]\n  R <- state[\"R\"]\n  \n  # Extracting the model parameters\n  # We are doing this for an SIR model, so we have two parameters - the transmission and recovery rate\n  beta <- parameters[\"beta\"]\n  gamma <- parameters[\"gamma\"]\n  \n  # Now we are going to use those previously extracted state variables and parameters to construct our model equations (differential equations)\n  dS <- -(beta*I*S)\n  dI <- (beta*I*S) - (gamma*I)\n  dR <- (gamma*I)\n  \n  # Now we will return those model equations as a list\n  return(list(c(dS,dI,dR)))\n}\n```\n\nNow all we need to do is specify the other parameters `y`, `parms`, and `times` and call `ode` with them like so:\n\n```{r}\nlibrary(deSolve)\n\n# Here we are specifying the initial values to be passed into the parameter y\n# Make sure these initial values line up exactly with the state variables extracted in the model function from before\ninitial_vals <- c(S=0.99,I=0.01,R=0)\n\n# Here we are specifying the parameters of the model and their values\n# Make sure these parameters line up exactly with the parameters extracted in the model function from before\nmodel_parameters <- c(beta=1.5,gamma=0.5)\n\n# Here we are specifying the times for which outputs are calculated\n# The closer together these times are, the higher the output resolution\noutput_times <- seq(0,50,by=1)\n\n# Now we can call the function ode like so:\noutput <- ode(func=ModelFunc,y=initial_vals,parms=model_parameters,times=output_times)\n\n# Printing the first 5 rows of the output matrix\nprint(head(output,5))\n```\n\nNow that we have this matrix of the solved SIR model equations are at specified times, we can plot it like so:\n\n```{r}\nmatplot(x = output[,\"time\"], y = output[,2:4], type = \"l\", lty = 1, xlab = \"time\", ylab = \"proportion\", main = \"Solved Example: Epidemic SIR Model\", col = c(\"blue\",\"red\",\"green\"))\n\n# Adding a legend\nlegend(\"topright\",legend = c(\"Susceptible\", \"Infectious\", \"Recovered\"), col = c(\"blue\",\"red\",\"green\"), lty = 1)\n```\n\n**Section References**\n\n@desolve_intro\n\n### Evaluating and Comparing Both Methods {#evaluating-and-comparing-both-methods}\n\nThe following table summarizes some potential benefits and drawbacks to using Euler's method or deSolve:\n\n| **Solving Method** | **Potential Benefits** | **Potential Drawbacks** |\n|--------------|-----------------------|------------------------------------|\n| Euler's Method | \\- Can be done by hand or implemented in code<br>- Simple to understand<br>- Full control over accuracy of model <br>- No external packages required | \\- Low accuracy unless an extremely small step size is used<br>- Computationally inefficient for small step sizes or complex models<br>- Can be tedious to calculate by hand |\n| deSolve Package | \\- Uses advanced solving methods with high accuracy<br>- Handles large models with many system equations well<br>- Efficient for complex models | \\- Less transparent approach; not much understanding of what is going on \"under the hood\"<br>- Requires learning new functions and syntax<br>- Depends on external packages<br>- Less control over solving method and accuracy |\n\nThe following simulation shows the difference between the solution curves produced by Euler's method and the deSolve package for different values of the model parameters and step size:\n\n<iframe src=\"http://127.0.0.1:4570\"\n        width=\"100%\"\n        height=\"700\"\n        style=\"border:none;\"></iframe>\n     \n\n## Reproduction Numbers\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Define what the basic and effective reproduction number is and recall primary differences between the two.\n\n-   Interpret the basic and effective reproduction number in context.\n\n-   Recall the formulas for the basic and effective reproduction numbers.\n\n-   Explain what the \"threshold phenomenon\" is.\n:::\n\nThe reproductive number is defined as \"the average number of secondary infectious cases caused by one infectious individual (before they recover or die or are otherwise not able to further transmit)\" [@Handel2021_IDEMA_ch5].\n\nThe table below summarizes the two types of reproduction numbers we will focus on:\n\n| **Name** | **Symbol** | **Interpretation** |\n|-------------|-------------|-----------------------------------------------|\n| Basic Reproduction Number | $R_0$ | The average number of secondary infections produced by a single infectious individual in a *completely susceptible* population. This can also be thought of as the reproduction number calculated at the beginning of an outbreak (when basically everyone is suceptible). |\n| Effective Reproduction Number | $R_{e}$ | The average number of secondary infections produced by a single infectious individual in a population with a susceptible proportion equal to $\\frac{S}{N}$ |\n\n::: {.callout-note}\nSome common misconceptions about $R_0$ and $R_e$ are:\n\n-   \"Must $R_0$ and $R_e$ be whole numbers because nobody can transmit the disease to, say, half a person?\"\n\n    -   No, $R_0$ and $R_e$ do not have to be whole numbers because they refer to *averages*, not the exact number of secondary infections produced by one person. An infectious person might infect nobody or tons of people but the reproduction numbers don't capture every detail just the overall picture of how many secondary infectious are produced.\n\n    <br>\n\n-   \"Is the reproduction number a rate?\"\n\n    -   No, the reproduction number is not a rate. Take the example of HIV and SARS, which both have $R_e\\approx4$. However, SARS has an extremely rapid spread while HIV is much slower spreading. One individual infected with SARS might cause 4 secondary infections within the span of a week while an individual with HIV most likely infects 4 other people within the span of a few years. $R_0$ and $R_e$ don't tell us anything about the timeframe of infections, so they are not rates.\n:::\n\nThe formula for the basic reproduction number is:\n\n$$\nR_0=\\frac{\\beta}{\\gamma}\n$$\n\nAnd similarly, the formula for the effective reproduction number is:\n\n$$\nR_e=\\frac{\\beta}{\\gamma} \\left( \\frac{S}{N} \\right) =R_0\\tilde{S}\n$$ These formulas should make sense, as they are multiplying the transmission rate $\\beta$ by the average duration of infection $\\frac{1}{\\gamma}$ to obtain the average number of secondary infections by one infectious individual throughout their entire duration of infectivity.\n\nThe point where these two formulas differ is in their assumption about the proportion of susceptible individuals in the population. $R_0$ assumes a completely susceptible population, so it is multiplying the expression $\\frac{\\beta}{\\gamma}$ by an invisible $1$. Meanwhile, $R_e$ assumes a susceptible proportion equal to $\\frac{S}{N}$ hence the final expression $\\frac{\\beta}{\\gamma}(\\frac{S}{N})$.\n\nMake sure you understand the definitions and intuition behind the formulas for $R_0$ and $R_e$. The [next section](#the-threshold-phenomenon) on the threshold phenomenon applies the reproduction number in learning how to control the spread of infection.\n\n**Section References**\n\n@Handel2021_IDEMA_ch5\n\n### The Threshold Phenomenon {#the-threshold-phenomenon}\n\nFirst described by Kermack and McKendrick, the threshold phenomenon refers to the critical point whereby an infection will either invade the population or fail to. To find this critical point, observe the change in the proportion of infectious individuals given by:\n\n$$\n\\frac{d\\tilde{I}}{dt} = \\beta \\tilde{I} \\tilde{S} - \\gamma \\tilde{I}\n$$ \n\nFactoring out the $\\tilde{I}$, we have:\n\n$$\n\\frac{d\\tilde{I}}{dt} = \\tilde{I}(\\beta \\tilde{S} - \\gamma)\n$$ \n\nIf we wish to find the point at which the infection either invades or fails to, we can solve for when $\\frac{d\\tilde{I}}{dt}<0$ (the proportion of infectious individuals is decreasing, or the disease is \"dying off\") and $\\frac{d\\tilde{I}}{dt}>0$ (the proportion of infectious individuals is increasing, or the disease is \"growing\").\n\nFirst, let's analyze when $\\frac{d\\tilde{I}}{dt}<0$:\n\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{I}}{dt} &< 0  && \\text{Condition that the infected population is decreasing} \\\\[10pt]\n\\tilde{I}(\\beta \\tilde{S} - \\gamma) &< 0  && \\text{Substitute } \\frac{d\\tilde{I}}{dt} = \\tilde{I}(\\beta \\tilde{S} - \\gamma) \\\\[10pt]\n\\beta \\tilde{S} - \\gamma &< 0  && \\text{Divide both sides by } \\tilde{I} > 0 \\\\[10pt]\n\\tilde{S} &< \\frac{\\gamma}{\\beta}  && \\text{Add } \\gamma \\text{ to both sides, then divide by } \\beta > 0\n\\end{aligned}\n$$\n\nReproducing this procedure, we obtain the following similar result:\n\n$$\n\\frac{d\\tilde{I}}{dt} > 0 \n\\;\\Longleftrightarrow\\; \n\\tilde{S} > \\frac{\\gamma}{\\beta}\n$$\n\nFrom this, we can deduce that for an infection to even invade the population and start spreading, the initial proportion of susceptibles must be greater than $\\frac{\\gamma}{\\beta}$. This result is what is specifically known as the *threshold phenomenon*, with $\\frac{\\gamma}{\\beta}$ known as the *threshold value*. Notice that $\\frac{\\gamma}{\\beta}$ is exactly equal to the inverse of the basic reproduction number $\\frac{1}{R_0}$, which means we can also rewrite these conditions like so:\n\n$$\n\\begin{aligned}\n\\text{Disease will not invade the population and / or spread:}\n\\qquad\n\\tilde{S} &< \\frac{1}{R_0}\n\\\\[10pt]\n\\text{Disease will invade the population and / or spread:}\n\\qquad\n\\tilde{S} &> \\frac{1}{R_0}\n\\end{aligned}\n$$\n\nThe simulation below let's you see the threshold phenomenon in action:\n\n<iframe src=\"http://127.0.0.1:4567\"\n        width=\"100%\"\n        height=\"700\"\n        style=\"border:none;\"></iframe>\n    \n\n::: {.callout-note}\nTry changing the initial proportion of susceptible individuals $S(0)$ to be above and below the rounded threshold value ($\\frac{\\gamma}{\\beta}$ ) shown. Notice that the proportion of infected individuals never increases if $S(0)<\\frac{\\gamma}{\\beta}$ but does increase if $S(0)>\\frac{\\gamma}{\\beta}$.\n:::\n\nConnecting this even further to reproduction numbers, we can rewrite the inequalities found above in terms of $R_e$ as follows:\n\n$$\n\\begin{aligned}\n\\qquad\n\\tilde{S} &< \\frac{\\beta}{\\gamma}\n\\qquad \\Longleftrightarrow \\qquad\nR_e < 1\n\\\\[10pt]\n\\qquad\n\\tilde{S} &> \\frac{\\beta}{\\gamma}\n\\qquad \\Longleftrightarrow \\qquad\nR_e > 1\n\\end{aligned}\n$$\n\nThe result above is a really important one: it tells us that $R_e$ is another threshold for determining whether or not a disease will spread. Specifically, if $R_e<1$, the disease is dying off but if $R_e>1$ the disease is spreading.\n\nThis should come as no surprise though, as it can be inferred from the definition of $R_e$ itself: if every single infectious person in the population (assuming the true value for the susceptible population, unlike $R_0$ which assumes a completely naive population), on average \"replaces\" themselves with more than $1$ infection, the disease will spread. Moreover, the point at which $R_e$ reaches exactly $1$ marks the maximum for the infected population since it is the point at which the disease goes from spreading (number of individuals infected rising) to dying off (number of individuals infected falling).\n\nThe simulation below demonstrates how the infected population increases, decreases, and reaches its maximum at different values of $R_e$:\n\n<iframe src=\"http://127.0.0.1:4568\"\n        width=\"100%\"\n        height=\"700\"\n        style=\"border:none;\"></iframe>\n     \n\n::: {.callout-note}\nNotice how $R_e$ starts off at its highest (when the population is almost entirely susceptible and it is equal to $R_0$), then decreases over time to be equal to $1$. At the point $R_e=1$, the proportion of infected individuals reaches a maximum. Then, as $R_e$ further decreases below $1$ the proportion of infected individuals starts decreasing as the epidemic \"dies off.\"\n:::\n\nTry expanding the window size in the simulation above and observe what happens to $R_e$ as $t \\rightarrow \\infty$. Notice that $R_e$ never reaches $0$! This demonstrates another important result: for an epidemic to end, it is not necessary to completely exhaust the susceptible population and attain $R_e=0$. The epidemic will start to end its course as soon as the proportion of susceptibles dips low enough to where $R_e<1$. When this happens, the infectious individuals will, on average, no longer be \"replacing\" themselves with another infectious person despite there still being a non-zero population of susceptible people. If this goes on for a long enough time, the chain of transmission will break because there will be no more infectious people to spread the infection not because there were no more susceptible people to infect. This means that at the end of every epidemic, there will always be some people who were never infected and are still susceptible.\n\nINSERT FLOW DIAGRAM THAT SHOWS EFF R AT VARIOUS FINITE STAGES AND ARROWS BETWEEN PEOPLE SPREADING THE INFECTION AND SAY THAT IF THERE IS LIKE 50 INFECTIOUS PEOPLE AND AN RE = 0.1 THEN 5 PEOPLE WILL GET INFECTED NEXT STAGE; ONCE THIS AVERAGE DIPS BELOW 1 PERSON FOR THE WHOLE INFECTIOUS POPULATION, DISEASE DIES OFF\n\nOf course, one of our primary goals is to expedite the natural decrease of $R_e$ to be below $1$ as quickly as possible, thus reducing and eventually fully stopping the spread of infection. One of the most effective public health measures to accomplish this is vaccination [@vaccines13050479]. The [next section](#choosing-how-many-people-to-vaccinate) answers the crucial following question: \"How many vaccinated people is enough?\".\n\n**Section References**\n\n@keeling_modeling_2008\n\n### Choosing How Many People to Vaccinate {#choosing-how-many-people-to-vaccinate}\n\nRecall from the [previous section](#the-threshold-phenomenon) that the disease will begin to die off when $R_e$ drops below $1$. The proportion of susceptible individuals $\\tilde{S}$ can be considered to be equal to $1-i$, where $i$ is the proportion of people in the population who are infectious or immune to the disease. We can rearrange the expression $R_e<1$ and solve for $i$:\n\n<br>\n\n$$\n\\begin{aligned}\nR_e &< 1 && \\text{Condition for disease to die off} \\\\[10pt]\nR_0 \\tilde{S} &< 1 && \\text{Definition of $R_e$} \\\\[10pt]\nR_0 (1-i) &< 1 && \\text{$\\tilde{S}=1-i$} \\\\[10pt]\ni &> 1-\\frac{1}{R_0} && \\text{Rearranging and solving for $i$}\n\\end{aligned}\n$$\n\n<br>\n\nAt the beginning of the outbreak, when nearly all individuals are susceptible and there are very few infectious, the proportion of individuals immune to the disease or infectious with it $i$ can be considered approximately equal to the proportion of individuals *successfully* vaccinated against the disease. This is because, generally speaking, vaccination confers immunity, though most of the time only temporary, to a disease (https://www.who.int/news-room/feature-stories/detail/how-do-vaccines-work). Since we are analyzing a relatively small time-frame with epidemics, the temporary nature of vaccine-conferred immunity can be safely disregarded.\n\nNotice the emphasis on the word \"successfully.\" This is because most vaccines are not $100%$ effective; there will always be a percentage of people, though however small, that are vaccinated but can still contract the disease. Assuming a vaccine efficacy rate of $e$, or the proportion of people who are vaccinated $p$ that are truly granted immunity, the proportion of individuals successfully vaccinated is $i=ep$. We can rearrange the expression found previously to find the proportion of the population $p$ that should be vaccinated at the start of the outbreak:\n\n<br>\n\n$$\n\\begin{aligned}\ni &> 1-\\frac{1}{R_0} && \\text{Minimum proportion of immune individuals i} \\\\[10pt]\nep &> 1-\\frac{1}{R_0} && \\text{Considering i=ep} \\\\[10pt]\np &> \\frac{1}{e}\\left(1-\\frac{1}{R_0} \\right) && \\text{Rearranging for p}\n\\end{aligned}\n$$\n\n<br>\n\nThis means that, for a vaccine with an efficacy rate $e$, at the proportion of people that should be vaccinated at the start of an outbreak to prevent further spread should be at least $\\frac{1}{e}(1-\\frac{1}{R_0}$. Not everyone in the population must be vaccinated to stop the spread of a disease, an idea known as *herd immunity*.\n\nHowever, sometimes herd immunity cannot be obtained. Take the case when $R_0=3$ and the best available vaccine has an efficacy rate of $e=0.6$ (meaning that of the people who are vaccinated, only about $60%$ of them will actually be immune and unable to contract the disease). Using the formula above, we find that the proportion of people who are vaccinated at the beginning of the outrbreak must be at least $\\frac{1}{0.6}(1-\\frac{1}{3})\\approx1.1$. However, this is impossible: we cannot possible vaccinate more than $100%$ of the population! This means that, due to a combination of the high transmissibility of the disease and the relatively low vaccine efficacy rate, even if $100%$ of the population were to be vaccinated, there would still be enough susceptible people (i.e. people whose vaccines were not effective) for an outbreak to occur.\n\n::: {.callout-note}\nNote that the above calculations and statements are assuming ideal vaccination practices at the beginning of an outbreak when nearly all individuals are susceptible and almost none are recovered or infectious. If vaccination is implemented mid-outbreak, when the number of recovered individuals with natural immunity and infectious people are not negligible, the calculations must be modified. In general, fewer individuals will have to be vaccinated than at the beginning of an outbreak since the proportion of susceptible individuals $\\tilde{S}$ will be equal to the complement of the sum of: the proportion of people who are infectious, those who have natural immunity due to recovery, and those who are successfully vaccinated.\n:::\n\n**Section References**\n\n@Handel2021_IDEMA_ch5\n\n## Example of the Classic Epidemic Model\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Identify examples of situations where the classic epidemic model is a useful tool for modeling.\n:::\n\nA disease commonly modeled using SIR-type models is measles due to its high infectivity and life-long immunity once recovered [@review_measles]. \n\naverage infectious period duration in Bjornstad paper reported a \"followed by a 6–7 d infective period\"\n\nhttps://esajournals.onlinelibrary.wiley.com/doi/full/10.1890/0012-9615%282002%29072%5B0169%3ADOMEES%5D2.0.CO%3B2#i0012-9615-72-2-169-anderson5\n\nFind beta using MLE\n\nJustification for not including E in model (Bjornstad paper): \"Humans, thus, enter the susceptible host population after a short delay. Following this, the high transmission rates ensured that 95% of all people in (prevaccination) urban areas were infected by the age of 15, and essentially everybody by the age of 20 (Anderson 1982). In the prevaccination era, the mean age of infection was ∼4–5 yr (Anderson and May 1991).\" \n\n\n## The Classic Endemic Model\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Recall the classic endemic model's equations.\n\n-   Differentiate the classic endemic model from the epidemic model.\n:::\n\nRecalling the information in [the section](#the-classic-sir-epidemic-model) on introducing the classic SIR epidemic model, the classic epidemic model assumes no demographics (births and deaths) in the population. This is because epidemics occur in such a relatively short timeframe, so the inclusion of births and deaths adds unnecessary complexity since so few will occur over this period.\n\nHowever, epidemic models are not suitable for all disease; there are some diseases that do not conclude their spread sufficiently fast to neglect the births and deaths that occur during that time. This is when the SIR model with demographics, also known commonly as the classic endemic model, comes in. The classic endemic model includes birth and death rates, but makes the following key assumptions about them:\n\n-   Every individual in the population has a natural \"lifespan\" of $\\frac{1}{\\mu}$ years, where $\\mu$ is the rate at which individuals die due to natural causes\n\n    -   $\\mu$ is independent of the disease and does not represent the pathogenicity of the disease, or its ability to cause death\n\n-   No deaths outside of natural ones dictated by the rate $\\mu$ occur; in other words, there are no separate disease related deaths and $\\mu$ is the crude death rate, or the death rate across people in all demographic groups and disease statuses (susceptible, infected, or recovered)\n\n-   $\\mu$ also represents the population's crude birth rate as well\n\n    -   This ensure that the total population size does not change as time goes on; as such, $N$ is a constant in the endemic SIR just as it is in the epidemic model\n\n-   Every individual is born into the susceptible population\n\n    -   Although for many disease (like measles for example) newborns are born with passive immunity due to the passing down of maternal antibodies, the average age at which passive immunity is lost is much lower than the typical age of first infection in developed countries. This tells us that it is reasonable to consider all newborns as being immediately susceptible since the time to their first infection is most likely independent of their initial fading immunity at birth. This is not true of diseases that have a very small mean age of infection, however, since an infection can happen as soon as passive immunity ends.\n\n**Section References**\n\n@keeling_modeling_2008\n\n::: {.callout-note}\nThe other assumptions made for the classic epidemic SIR apply to the endemic SIR model as well. We are just simply adding these new assumptions about the characteristics of the birth and death rates in the population. These assumptions are common but it should be noted that not all SIR models with demographics will make the same assumptions as above.\n:::\n\nThe flowchart for the classic endemic model can be seen below:\n\nINSERT FLOWCHART OF ENDEMIC MODEL\n\nFrom this flowchart, we can deduce the following equations for the number of people in each compartment according to the endemic SIR model:\n\n$$\n\\begin{aligned}\n\\frac{dS}{dt} &= \\mu-\\beta \\tilde{I} S - \\mu S \\\\[10pt]\n\\frac{dI}{dt} &= \\beta \\tilde{I} S - \\gamma I - \\mu I\\\\[10pt]\n\\frac{dR}{dt} &= \\gamma I - \\mu R\n\\end{aligned}\n$$\n\nAnd just like before, we can divide every equation above by the constant population size $N$ to obtain the following equations for the proportion of individuals in each compartment:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt} &= \\mu-\\beta \\tilde{I} \\tilde{S} - \\mu \\tilde{S} \\\\[10pt]\n\\frac{d\\tilde{I}}{dt} &= \\beta \\tilde{I} \\tilde{S} - \\gamma \\tilde{I} - \\mu \\tilde{I}\\\\[10pt]\n\\frac{d\\tilde{R}}{dt} &= \\gamma \\tilde{I} - \\mu \\tilde{R}\n\\end{aligned}\n$$\n\nNotice that the force of infection for the endemic model is the same as the epidemic model ($\\lambda=\\beta \\tilde{I}$.\n\nThe following sections are mostly reviews of concepts covered previously in the epidemic model. For this reason, they are mostly short sections but do cover important distinctions between the epidemic and endemic model, including how their reproduction numbers are calculated and how to solve them using deSolve just to name a few.\n\n## Formulating the Death Rate\n\nFIND SOURCE ON FORMULATING DEATH RATE; I ASSUME WE CAN SIMPLY FIND SOURCES THAT SAY THE DEATH RATE IS 1/AVG LIFE EXPECTANCY IN POPULATION\n\n## Solving the Endemic SIR Model - Example\n\nThe endemic SIR model can be solved using many of the same methods as the epidemic SIR model. In [the previous section](#solving-sir-equations) on solving the epidemic SIR model, we covered two main methods of doing so: Euler's method and the deSolve package in R.\n\nBoth of these methods can be used to solve the endemic model as well, but we will only show an example of solving the endemic model using deSolve since Euler's method is quite lengthy and is the exact same process as for the epidemic model just with different SIR equations.\n\nBelow is a complete example of using the deSolve package to solve an endemic SIR model and plotting the results:\n\n```{r}\nlibrary(deSolve)\n\nModelFunc <- function(time,state,parameters){\n  # Extracting the state variables\n  # Same compartments as before: susceptible, infectious, and recovered\n  S <- state[\"S\"]\n  I <- state[\"I\"]\n  R <- state[\"R\"]\n  \n  # Extracting the model parameters\n  # We now have three parameters - the transmission rate, recovery rate, and mortality rate\n  beta <- parameters[\"beta\"]\n  gamma <- parameters[\"gamma\"]\n  mu <- parameters[\"mu\"]\n  \n  # Using the previously extracted state variables and parameters to construct our model equations (differential equations)\n  dS <- mu - (beta*I*S) - mu*S\n  dI <- (beta*I*S) - (gamma*I) - mu*I\n  dR <- (gamma*I) - mu*R\n  \n  # Returning model equations as a list\n  return(list(c(dS,dI,dR)))\n}\n\n# Specifying the initial values to be passed into the parameter y\n# Make sure these initial values line up exactly with the state variables extracted in the model function from before\ninitial_vals <- c(S=0.99,I=0.01,R=0)\n\n# Specifying the parameters of the model and their values\n# Make sure these parameters line up exactly with the parameters extracted in the model function from before\nmodel_parameters <- c(beta=1.5,gamma=0.3,mu=0.2)\n\n# Times for which outputs are calculated\n# The closer together these times are, the higher the output resolution\noutput_times <- seq(0,50,by=1)\n\n# Now we can call the function ode\noutput <- ode(func=ModelFunc,y=initial_vals,parms=model_parameters,times=output_times)\n\n# Plotting the output\nmatplot(x = output[,\"time\"], y = output[,2:4], type = \"l\", lty = 1, xlab = \"time\", ylab = \"proportion\", main = \"Solved Example: Endemic SIR Model\", col = c(\"blue\",\"red\",\"green\"))\n\n# Adding a legend\nlegend(\"topright\",legend = c(\"Susceptible\", \"Infectious\", \"Recovered\"), col = c(\"blue\",\"red\",\"green\"), lty = 1)\n```\n\n::: {.callout-note}\nNotice that the curves above seem to \"even out\" after a while? This is a really important distinction between the epidemic and endemic SIR model, and is explained in detail in [the future section on model equilibriums](#disease-free-and-endemic-equilibrium). \n:::\n\n## Reproduction Numbers\n\nThe basic and effective reproduction numbers for the endemic SIR model have the same interpretation as they do for the epidemic SIR model. Refer back to [this section](#reproduction-numbers) on reproduction numbers in the epidemic SIR model if you need a refresher of these definitions. \n\nAlthough they have the same interpretations before, the formulas for the basic and reproductive number are different for the endemic SIR model. \n\nFirst, let's formulate the basic reproductive number $R_0$ for the endemic SIR model. We still utilize $\\beta$ as the per-capita transmission rate but instead of considering the average time an individual is infectious to be $\\frac{1}{\\gamma}$ (like it is for the epidemic SIR model), we consider it to be $\\frac{1}{\\gamma+\\mu}$. On a conceptual level, this is justified because there are now two ways to leave the infectious class: recovery or death. Before in the epidemic model, there was only one way to become noninfectious---through recovery. \n\nMultiplying the tranmission rate $\\beta$ by the average time an individual will stay infectious $\\frac{1}{\\gamma+\\mu}$, we obtain the the basic reproduction number $R_0$ for the epidemic SIR model:\n\n$$\nR_0=\\frac{\\beta}{\\gamma+\\mu}\n$$\n\n::: {.callout-note}\nThis basic reproduction number for the endemic model is generally similar to, but always smaller than, the basic reproduction number for the epidemic model since the natural morality rate reduces the average time an individual is infectious (we now consider the possibility that individuals can die to natural causes while infectious, thus reducing their \"infective potential\"). \n:::\n\nThe effective reproduction number $R_e$ for the endemic model is quite similar to the epidemic model. It is still found by multiplying the basic reproduction number $R_0$ by the proportion of susceptible individuals in the population $\\tilde{S}$ like so:\n\n$$\nR_e=R_0 \\tilde{S}=\\left(\\frac{\\beta}{\\gamma+\\mu} \\right) \\tilde{S}\n$$\n\n## Disease Free and Endemic Equilibrium\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Define what an equilibrium is the context of a system of differential equations.\n\n-   Find the values where the disease-free and endemic equilibrium occur.\n\n-   Recall when each equilibrium type occurs in relation to R0 and justify it based on the definition of R0.\n:::\n\nThe inclusion of births in the endemic model means there is a constant \"replenishing\" of the susceptible population. This allows for the disease to persist in the population in the long-term, unlike the epidemic model which always ends in the disease \"dying off.\" \n\nTo analyze the long-term behavior of the endemic model, we start by analyzing what the model equations look like at *equilibrium*, or the point when $\\frac{dS}{dt}=\\frac{dI}{dt}=\\frac{dR}{dt}=0$. \n\n::: {.callout-note}\nIt is important to note that equilibrium doesn't mean a lack of individuals flowing between each compartment but rather a *balanced* flow of individuals between each compartment. This means that the same number or proportion of individuals are entering and leaving each compartment at a given time, so the net change in the number or proportion of individuals in each compartment is $0$. \n\nWe can understand this just by looking at the model equations themselves. Take the susceptible population as an example, dictated by the rate:\n\n$$\n\\frac{dS}{dt} = \\mu-\\beta \\tilde{I} S - \\mu S\n$$\n\nWe can see that for $\\frac{dS}{dt}$ to be equal to $0$, it is not necessary that $0$ people are entering the susceptible population (i.e. being born) and $0$ people are leaving the susceptible population (i.e. getting infected). It is simply necessary that the flow rate *into* the susceptible population (given by the birth rate term \\mu) is the same as the flow rate *out* of the susceptible population (given by the infection term $\\beta \\tilde{I} S$ and the death rate term $\\mu S$). \n:::\n\nThe equilibrium of a system of differential equations is found by setting each rate of change equal to $0$ and finding the solution(s) of the resulting system:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt} = 0, \\quad \\frac{d\\tilde{I}}{dt} = 0, \\quad \\frac{d\\tilde{R}}{dt} = 0 \n& \\quad && \\text{Equilibrium set up} \\\\[10pt]\n\\frac{d\\tilde{I}}{dt} = \\beta \\tilde{I} \\tilde{S} - \\gamma \\tilde{I} - \\mu \\tilde{I} = 0 \n& \\quad && \\text{Focus on the infected equation} \\\\[10pt]\n\\tilde{I}(\\beta \\tilde{S} - \\gamma - \\mu ) = 0 \n& \\quad && \\text{Factor out } \\tilde{I} \\text{ to solve for equilibrium} \\\\[10pt]\n\\tilde{I}^* = 0 \\quad \\text{or} \\quad \\tilde{S}^* = \\frac{\\gamma + \\mu}{\\beta}=\\frac{1}{R_0}\n& \\quad && \\text{Two potential solutions}\n\\end{aligned}\n$$\n\n\n\n::: {.callout-note}\nNote that above equilibrium system is solved using the endemic model equations for the proportion, not number, of individuals in each compartment. A similar procedure can be replicated to solve for the number of individuals in each compartment at the equilibrium. \n\nThe values at which the equilibrium occur are often denoted using an asterisk ($*$) above the variable. For consistency and clarity, the values at which the equilibrium occurs for the proportion endemic model will be denoted with $\\tilde{S}^*$, $\\tilde{I}^*$, and $\\tilde{R}^*$. Likewise, the values at which the equilibrium occurs for the number endemic model will be denoted with $S^*$, $I^*$, and $R^*$. \n:::\n\nNotice that we actually have two possible solutions for the equilibrium, one where $\\tilde{I}^*=0$ and another when $\\tilde{S}^* = \\frac{1}{R_0}$. We can solve for the values of the other variables at these points, starting with when $\\tilde{I}^*=0$:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt}=\\mu - \\mu \\tilde{S}=0 \\implies \\tilde{S}^*=1\n& \\quad && \\text{Substituting } \\tilde{I}=0 \\text{ into } \\frac{d\\tilde{S}}{dt}=0 \\\\[10pt]\n\\frac{d\\tilde{R}}{dt}= - \\mu \\tilde{R} =0 \\implies \\tilde{R}^*=0\n& \\quad && \\text{Substituting } \\tilde{I}=0 \\text{ into } \\frac{d\\tilde{R}}{dt}=0 \\\\[10pt]\n\\end{aligned}\n$$\n\nThis gives us one set of values where an equilibrium can occur:\n\n$$\n(\\tilde{S}^*,\\tilde{I}^*,\\tilde{R}^*)=(1,0,0)\n$$\nThe other set of values corresponding to an equilibrium point can be obtained by solving for the values of $\\tilde{I}^*$ and $\\tilde{R}^*$ when $\\tilde{S}^*=\\frac{1}{R_0}$:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt}=\\mu - \\beta \\tilde{I} \\left(\\frac{1}{R_0} \\right) -\\mu \\tilde{S}=0 \\implies \\tilde{I}^*=\\frac{\\mu}{\\beta}(R_0-1)\n& \\quad && \\text{Substituting } \\tilde{S}=\\frac{1}{R_0} \\text{ into } \\frac{d\\tilde{S}}{dt}=0 \\\\[10pt]\n\\tilde{S}+\\tilde{I}+\\tilde{R}=1 \\implies \\tilde{R}^*=1-\\frac{1}{R_0}-\\frac{\\mu}{\\beta}(R_0-1)\n& \\quad && \\text{Using total population equation}\\\\[10pt]\n\\end{aligned}\n$$\n\nNow we have both sets of values where an equilibrium occurs:\n\n$$\n\\begin{aligned}\n(\\tilde{S}^*,\\tilde{I}^*,\\tilde{R}^*) &= (1,0,0) \\\\[10pt]\n(\\tilde{S}^*,\\tilde{I}^*,\\tilde{R}^*) &= \\left(\\frac{1}{R_0}, \\frac{\\mu}{\\beta}(R_0-1), 1 - \\frac{1}{R_0} - \\frac{\\mu}{\\beta}(R_0-1)\\right)\n\\end{aligned}\n$$\n\nEach of these two sets of values correspond to their own equilibrium points which have their own special names, summarized in the table below:\n\n\n| **Name** | **$(\\tilde{S}^*,\\tilde{I}^*,\\tilde{R}^*)$** | **What Is Happening At This Point?** |\n|-------------|-------------|-----------------------------------------------|\n| Disease-Free Equilibrium | $(1,0,0)$ | A stable point wherein the the disease has completely left the population and all recovered individuals have died due to natural causes. It can be interpreted as a population \"untouched\" by the disease. |\n| Endemic Equilibrium | $\\left(\\frac{1}{R_0}, \\frac{\\mu}{\\beta}(R_0-1), 1 - \\frac{1}{R_0} - \\frac{\\mu}{\\beta}(R_0-1)\\right)$ | A stable point wherein the disease has established itself in the population and become *endemic*. A disease is endemic when \"it is consistently present but limited to a particular region,\" which in the case of the endemic SIR model is our particular region of study [@endemic_article]. |\n\nThe next question that arises is when do these equilibrium points occur? The answer lies in the value of $R_0$: the endemic equilibrium is *asymptotically stable* when $R_0>1$, otherwise if $R_0\\leq1$ then the disease-free equilibrium is stable. \n\n:::{.callout-note}\nThe stability of model systems can be a difficult concept to grasp, but in general we can think of the above statement as saying that when $R_0\\leq 1$ or the initial proportion of infected individuals equals 0, all valid solution paths (solutions which exist for all positive time and are unique) approach the disease-free equilibrium given by $(\\tilde{S}^*,\\tilde{I}^*,\\tilde{R}^*)=(1,0,0)$. Similarly, when $R_0>1$, all valid solution paths with an intitial proportion of infected individuals greater than $0$ will approach the endemic equilibrium [@hethcote_math_infection].\n\nThis makes sense intuitively, as if $R_0\\leq1$ the pathogen can't invade the population since every new infectious individual would only, on average, pass on the disease to one or fewer hosts. Eventually the chain of transmission would break and the disease-free equilibrium  would be approached asymptotically (over time). \n\nLikewise, if $R_0>1$ the pathogen can invade the population with even just the smallest introduction of infectious individuals since they will successively infect more people (who will then infect more even more people, etc.). The chain of transmission will not break either like it does in the epidemic SIR model since the population of susceptibles is constantly being \"replenished\" via new births, so the disease-free equilibrium is approached asymptotically. \n:::\n\nThe simulation below lets you see which equilibrium will be approached for different values of $R_0$ and initial proportion of infected individuals:\n\n<iframe src=\"http://127.0.0.1:4569\"\n        width=\"100%\"\n        height=\"700\"\n        style=\"border:none;\"></iframe>\n     \n\n:::{.callout-note}\nTry setting the transmission rate to $1$, the recovery rate to $0.7$, and the birth / death rate to $0.4$. Notice that under these model parameters, the basic reproduction number $R_0$ is barely under $1$ ($R_0\\approx0.909$). Now try changing the initial proportion of infected individuals and observe what happens to the SIR curves over time. Even for an initial infected proportion of $1$ (at the start everyone is infected), the curves still approach the disease-free equilibrium as expected! \n\nNow try setting the parameters to result in $R_0>1$ and observe the proportion of susceptible, infected, and recovered individuals as time progresses (you can see the exact proportions by hovering over each curve). Do these line up exactly with values at the endemic equilibrium point calculated before? \n:::\n\n\n\n\n\n\n\n\n\n\n\n\n","srcMarkdownNoYaml":"\n\n\n\n```{r}\nsystem(\"Rscript ./run_app_script.R &\")\nSys.sleep(5)\n```\n\n## Introduction and Course Learning Objectives\n\n## Epidemiology Terms\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Define basic terms in epidemiology.\n:::\n\nFor the purposes of mathematical models in epidemiology, such as the SIR model, individuals are classified based solely on their ability to transmit a pathogen, not their diseased status (whether or not they exhibit symptoms). For the purposes of epidemiological models, individuals are generally classified into four primary categories:\n\n-   **Susceptible:** No pathogen is present in the individual. The individual only has a low level of non-specific immunity to incoming infection.\n\n-   **Exposed:** The individual has encountered an infected individual and is infected with the pathogen. The levels of pathogen in this individual are too low to allow them to transmit the disease to another person. This individual is hence considered \"exposed\" to the pathogen but not yet able to infect others with it.\n\n-   **Infectious:** The individual has surpassed the exposed stage and the pathogen levels within them are high enough to allow for transmission. This individual is no longer just exposed to the pathogen, but can actively spread it now.\n\n-   **Recovered:** The individual has surpassed the infectious stage, their immune system has cleared enough of the pathogen that they can no longer transmit it. This individual has some amount of immunity to the pathogen now, but for how long this immunity lasts depends on the specific pathogen.\n\n::: {.callout-note}\nThe individual can still exhibit symptoms of the disease while in the recovered compartment, so it is best to think of this compartment as individuals who have \"recovered\" from their ability to spread the infection but not necessarily all symptomatic implications of that infection.\n:::\n\nThese categories are not exhaustive, and individuals can be classified into further categories based on their stage of infection or immunity status, just to name a few. These four categories are highlighted since they come up most often while discussing SIR-type models and epidemiological models in general. It is important to note that, at the same time individuals fall into these categories, they can also be classified based on whether or not they exhibit symptoms of infection:\n\n-   **Incubation Period:** The individual has been infected with the pathogen but does not show disease symptoms. This is also commonly refferred to as the *asymptomatic period*.\n\n-   **Diseased period:** The individual has surpassed the incubation period and begins to show symptoms of the disease.\n\nAlthough these classifications are more commonly used in a medical, rather than an epidemiological, contexts, we still provide them here to clarify the fact that an individual can still be infectious while in the incubation period and showing no symptoms of the disease. Similarly, an individual can still be in the diseased period and show lingering symptoms of infection while being recovered since their immune system has cleared enough of the pathogen that they are not longer infectious.\n\n(PLACE GRAPH HERE OF ALL THESE PERIODS)\n\n**Section References**\n\n@keeling_modeling_2008\n\n## Introducing Compartmental Models {#introducing-compartmental-models}\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Define what a compartmental model is.\n-   Identify which differential equation models can be called compartmental models.\n:::\n\nGenerally speaking, compartmental models are a way to represent the flow of populations between different states, known as compartments, using differential equations. Compartmental models show up in a wide variety of fields, not just epidemiology. Any field that can benefit from knowing how information flows between states can benefit from compartmental models.\n\nIn the epidemiological context, compartmental models are analyzing how people flow through the four categories, which will be referred to simply as \"compartments\" from now on, introduced in the previous section: susceptible, exposed, infectious, and recovered. The relationships between these compartments are often represented using flowcharts like the one seen below.\n\n(INSERT IMAGE OF SEIR FLOWCHART THAT SPECIFICALLY SHOWS LAMBDA INSTEAD OF BETA AS THE FLOW RATE BETWEEN S AND E)\n\nThe arrows between these compartments represent the direction of flow (susceptible individuals becoming exposed, exposed individuals becoming infectious, etc.) and the symbols above each arrow represent the *flow rate* between these compartments with respect to time.\n\nIt's easiest to understand this conceptually through an example. Say in a very large population with the established presence of a pathogen, on average, 300 new people become exposed to a pathogen every day. Of those that are exposed to the pathogen, on average, 50 of them reach pathogen levels high enough to become infectious per day. Then, of those that are infectious and able to transmit the pathogen, on average, 40 of them recover from the pathogen (in the sense that they can no longer transmit it). We can model this specific example with the modified flowchart below:\n\nWhich compartments we choose to include depends on the specific pathogen and disease we are modeling. Models where the exposed period is so small it can be considered negligible, or is ommited for the sake of simplicity, are specifically known as *SIR models* (standing for the three different compartments included in the model: susceptible, infectious, and recovered).\n\n::: {.callout-note}\nSome sources will refer generally to any compartmental epidemiological model as an \"SIR model,\" but in our context we will make the distinction between SIR models and models that include different compartments than just susceptible, infectious, and recovered.\n\nWe will, however, refer to the general idea of compartmental epidemiological models as \"SIR-type models.\"\n:::\n\nThe [next section](#the-classic-sir-epidemic-model) covers the specific formulation and assumptions of this model.\n\n### Learning Assessment:\n\nMake assessment that's like given what compartments these letters represent draw a flowchart for the following models like SEIR SMEIR SIS SIRS etc\n\n**Section References**\n\n@keeling_modeling_2008\n\n## The Classic SIR Epidemic Model {#the-classic-sir-epidemic-model}\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Recall the classic epidemic model's equations.\n\n-   Construct equations for novel compartmental models given the flow rates between each of the compartments.\n\n-   Identify the assumptions (and their justifications) made in the formulation of the classic epidemic model, including the assumptions made in relation to how its parameters were obtained / formulated.\n\n-   Recall what parameters go into the construction of the classic epidemic model, including the typical symbols for each.\n\n-   Explain how the classic epidemic model deviates from reality in relation to the assumptions it makes.\n\n-   Differentiate situations where an empirically deduced transmission rate is more accurate and beneficial to one calculated based on first principles.\n\n-   Discern what situations are best modeled by frequency or density dependent transmission rates, or a combination of both.\n:::\n\nThe classic SIR epidemic model is a type of compartmental model that makes the following key assumptions:\n\n1.  The epidemic invades the population and concludes itself quickly enough that demographic processes, namely births and deaths, are not very influential to the overall process and can be omitted from the model. This is also known as the *closed population* assumption.\n\n2.  Individuals move between the compartments of susceptible, infectious, and recovered only. Other compartments, namely the exposed compartment, are omitted for simplicity.\n\n::: {.callout-note}\nSince this module covers only the epidemic and endemic SIR models, neither of which include the exposed compartment, the terms \"infected\" and \"infectious\" will be used interchangeably moving forward. This is because with only the susceptible, infectious, and recovered compartments, once an individual gets infected with the pathogen we assume they are infectious as well.\n\nIt is important to note that although \"infected\" and \"infectious\" are used interchangeably within the context of this learning module, they are not synonymous all the time. As model complexity increases and the exposed compartment is included, a distinction must be made between the two, as an individual can be considered \"infected\" but not \"infectious\" (i.e. they belong to the exposed compartment).\n:::\n\nThese are not the only assumptions made by the epidemic SIR model, but they do clearly distinguish it from other compartmental models such as the SEIR model, which includes exposed compartment, and the endemic SIR model, which includes the flow in and out of each compartment due to demographics (births and death).\n\nMoving forward, $S$. $I$, and $R$ will refer to the *number* of individuals in the susceptible, infectious, and recovered compartments, respectively. The variables $\\tilde{S}=\\frac{S}{N}$, $\\tilde{I}=\\frac{I}{N}$, and $\\tilde{R}=\\frac{R}{N}$, will be used to refer to the *proportion* of individuals in the susceptible, infectious, and recovered compartments, respectively, where $N$ is the total number of individuals in the population defined as $N=S+I+R$.\n\n::: {.callout-note}\n-   Since the epidemic model assumes a closed population with no births or deaths, $N$ is not a variable that can change but a constant.\n\n-   Notice that $\\tilde{S}+\\tilde{I}+\\tilde{R}=1$\n:::\n\nThe following equations provide the rates of change, with respect to time, for the number of individuals in each of the three compartments of the epidemic SIR model:\n\n$$\n\\begin{aligned}\n\\frac{dS}{dt} &= -\\lambda S \\\\[10pt]\n\\frac{dI}{dt} &= \\lambda S - \\gamma I \\\\[10pt]\n\\frac{dR}{dt} &= \\gamma I\n\\end{aligned}\n$$\n\nDividing each equation by the population size $N$, we can rewrite the SIR equations above to provide the rates of change, with respect to time, for the proportion of individuals in each compartment:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt} &= -\\lambda \\tilde{S} \\\\[10pt]\n\\frac{d\\tilde{I}}{dt} &= \\lambda \\tilde{S} - \\gamma \\tilde{I} \\\\[10pt]\n\\frac{d\\tilde{R}}{dt} &= \\gamma \\tilde{I}\n\\end{aligned}\n$$\n\n::: {.callout-note}\nThe rate of change of the number of people in each compartment can be understood as following the basic pattern of $R_i-R_o$ where $R_i$ is the rate that people are flowing into the compartment per unit time and $R_o$ is the rate that people are flowing out of the compartment per unit time. This pattern can be used to construct any number of novel compartmental models.\n:::\n\nNotice that these equations mirror exactly the compartmental flowcharts introduced in the [previous section](#introducing-compartmental-models). The epidemic SIR model can be representing using the following flowchart:\n\nThe flow rates between each compartment have specific names and symbology, summarized in the table below:\n\n| **Terminology / Name** | **Common Symbol** | **Interpretation** |\n|-------------------|------------------|-----------------------------------|\n| Force of Infection | $\\lambda$ | The per capita rate at which susceptible individuals are becoming infectious per unit time. |\n| Recovery Rate | $\\gamma$ | The per capita rate at which infectious individuals are recovering from infection per unit time. |\n\n::: {.callout-note}\nThe phrase \"per capita\" here refers to a rate that is divided among each person in the given compartment. Take the following example: if 3 people are pouring water into a large bucket and each are adding 5 cups per minute, then the per capita rate at which water is being added is 5 cups per minute. To obtain the total rate at which water is being poured into the bucket, we would multiply the number of people pouring, 3, by their per capita rate, 5, to get a total inflow of 15 cups per minute.\n\nA similar logic is being utilized in the SIR equations: the number of susceptible people at a given time, $S$, is multiplied by the per capita rate they are becoming infectious to get the total rate at which people are entering the infectious compartment Similarly, the number of infectious people at a given time, $I$, is multiplied by the per capita rate they are recovering to get the total rate at which people are entering the recovered compartment\n:::\n\n**Section References**\n\n@keeling_modeling_2008\n\n### Formulating the Force of Infection\n\nThe force of infection, or the rate at which susceptible individuals are becoming infected per unit time, can be understood and formulated based on first principles in epidemiology as follows:\n\n> Consider the perspective of a susceptible individual in the population at any given time. Let's say this individual makes, on average, $c$ contacts with other people per unit time. Then, suppose that of those $c$ people this individual makes contact with per unit time, the proportion of them that will be infectious is $\\tilde{I}$. Then, of those $c\\tilde{I}$ contacts this individual makes with infectious people, the proportion of them that will actually succeed at spreading the infection to them is $p$. Multiplying these together, we can obtain the per capita (per person) rate which susceptible people are becoming infectious, or the force of infection as follows: $$\n> \\lambda=cp\\tilde{I}\n> $$\n\n::: {.callout-note}\nAlthough this formulation for $\\lambda$ is based on first principles, there are still a number of assumptions being made. Namely:\n\n1.  We assume every individual in the population comes into contact with other individuals at a constant rate $c$. This means we assume everyone in the population is equally sociable and, on average, comes into contact with the same number of people per unit time.\n\n2.  We assume *homogeneous mixing* of the population. That is, we assume everyone has an equal probability of contacting any other individual in the population. In real life, this is of course not true: infectious individuals are more likely to come into contact with other infectious individuals if they go to the hospital and are less likely to come into contact with susceptible individuals if they quarantine, just to name a few examples.\n:::\n\nThe force of infection is calculated in many ways; we just provide one of many possible formulations and rationales here. Notice there are two constant terms in the formulation for $\\lambda$ given above: $c$ and $p$. Since these terms are independent of the number of individuals in each compartment throughout time, they are grouped together into a singular term, known as the *transmission rate*. As it is generally unaffected by the dynamics of the model itself, the transmission rate---often denoted as $\\beta$---is considered a property of the specific disease or pathogen being analyzed and is formulated prior to the construction of the model.\n\nPutting this all together, we can rewrite the SIR model equations from the [previous section](#the-classic-sir-epidemic-model) as follows:\n\n$$\n\\begin{aligned}\n\\frac{dS}{dt} &= -\\beta \\tilde{I} S \\\\[10pt]\n\\frac{dI}{dt} &= \\beta \\tilde{I} S - \\gamma I \\\\[10pt]\n\\frac{dR}{dt} &= \\gamma I\n\\end{aligned}\n$$\n\nAnd for proportions:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt} &= -\\beta \\tilde{I} \\tilde{S} \\\\[10pt]\n\\frac{d\\tilde{I}}{dt} &= \\beta \\tilde{I} \\tilde{S} - \\gamma \\tilde{I} \\\\[10pt]\n\\frac{d\\tilde{R}}{dt} &= \\gamma \\tilde{I}\n\\end{aligned}\n$$\n\nNow comes the question of how we even find $\\beta$? The table below presents two common methods for calculating $\\beta$:\n\n| **Method** | **What is it?** | **Best Used When . . .** |\n|------------------|----------------------------------|---------------------|\n| Blackbox method | This is a data-driven method wherein $\\beta$ is calculated empirically using epidemiological data. We can think of this as \"fitting\" a value of $\\beta$ in our model to most accurately reflect the dynamics we observe in the real world. | There is an abundance of accurate real-world data available on the number of susceptible and infectious people over time. |\n| First-Principles method | This method utilizes the formulation $\\beta=cp$, which was obtained using first-principles, and separately calculates appropriate values for $c$ and $p$. | Real-world data is scarcer or there the data available lends itself better to calculating $c$ and $p$ separately rather than fitting an overall $\\beta$. |\n\n\nFor the purposes and scope of this introductory module, we will only provide examples and insights into the blackbox method for calculating the transmission rate $\\beta$. This is because specifics of how $c$ and $p$ are calculated using the first-principles method depends heavily on model context and complexity, meaning there is no \"one size fits all\" way of finding $\\beta$ using this method. \n\nModels will often formulate $c$ and $p$ as functions of their own depending on a number of external variables. An example of this can be found in this paper [@deer_covid], where the transmission rate $\\beta$ is formulated as the product of the proximity rate $\\omega_{ij}$, or \"frequency per day that host $i$ and recipient $j$ are within 1.5 meters (m) of each other\" and $\\sigma^{Aero}$, or the \"probability of infection from aerosols.\" The paper further decomposes $\\omega_{ij}$ and $\\sigma^{Aero}$ into functions of their own depending on a variety of external variables. \n\nThe specific formulations for the contact rate (or proximity rate) and infection probability utilized by this paper are unique to its context (the pathogen it is analyzing, the host population(s), etc.) and will vary widely from paper to paper. PROVIDE CITATIONS FOR MORE EXAMPLES OF DIFFERENT BETA CALCULATIONS HERE. \n\n\nHowever, there are standardized procedures to obtain $\\beta$ using the blackbox approach, of which one common method known as *maximum likelihood estimation* is covered in the next section.\n\nCITATION: difficult to say, mixture of Keeling / Rohani book and own intuition of these concepts\n\n### Formulating the Transmission Rate, Recovery Rate, and Other Parameters\n\nhttps://scholarworks.lib.csusb.edu/cgi/viewcontent.cgi?article=2232&context=etd\n\nThe paper linked above is a great intro-SIR paper in general and motivates the formulation of the recovery rate as 1 over the average duration of infection. \n\n## Solving SIR Equations\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Solve basic SIR model equations using a combination of mathematical and computational techniques.\n\n-   Identify the difference between common methods of solving SIR-type models, including Euler's method and the deSolve package in R.\n:::\n\nTwo common methods of solving differential equations that are difficult to solve by hand (in an exact method, that is) is:\n\n1.  Euler's method\n2.  The deSolve package in R\n\nWe will go over each method in this section and the differences between the two.\n\n### Euler's method\n\nEuler's method estimates the solution to a differential equation using a series of short, connected linear approximations at a discrete set of times. Although Euler's method is widely regarded to be a relatively inefficient method for solving otherwise \"unsolvable\" (at least in the elementary sense) ordinary differential equations, it is still valued for its simplicity and accessibility.\n\nSuppose we have approximate initial values for the variables of interest (which, in the case of the SIR model, is the number or proportion of susceptible, infectious, and recovered individuals at the beginning of our study period). We will denote the number of susceptible, infectious, and recovered individuals at starting time $t$ as $S(0)$, $I(0)$, and $R(0)$, respectively.\n\n::: {.callout-note}\nTo keep it simple, we will only discuss the process of Euler's method as it is applied to the number of individuals in each compartment, but keep in mind this process can be applied in exactly the same way to proportions as well.\n:::\n\nOur goal is to find an approximate solutions to $S(t)$, $I(t)$, and $R(t)$---the number of individuals in each compartment at time $t$---using $s(0)$, $i(0)$, and $r(0)$ and the rates of change given by the system of SIR equations formulated in [this section](#the-classic-sir-epidemic-model). For clarity, $S(t)$, $I(t)$, and $R(t)$ represent the exact solutions to the SIR equations, and the approximation solutions given by Euler's method are represent as $s(t)$, $i(t)$, and $r(t)$.\n\n::: {.callout-note}\nThese types of problems, one where we are given a set of intial values and corresponding differential equations, are known as initial-value problems (or IVPs).\n:::\n\nEuler's method involves repeatedly finding tangent line approximations to $S(t)$, $I(t)$, and $R(t)$ at a discrete set of times (often called nodes):\n\n-   $s_0,\\dots,s_t,\\dots,s_b$\n-   $i_0,\\dots,i_t,\\dots,i_b$\n-   $r_0,\\dots,r_t,\\dots,r_b$\n\n::: {.callout-note}\n$s_t$, $i_t$, and $r_t$ represent approximations to $S(t)$, $I(t)$, and $R(t)$ at a time $t$. Additionally, $s_b$, $i_b$, and $r_b$ just represent the approximation at the final time $b$ of the interval we wish to find an approximate solution to, or $[0,b]$ .\n:::\n\nThese approximations are found using the following recursive formulas:\n\n$$\n\\begin{aligned}\ns_{t+1} &= s_t - \\Delta t \\, \\beta i_t s_t \\\\[10pt]\ni_{t+1} &= i_t + \\Delta t \\, (\\beta i_t s_t - \\gamma i_t) \\\\[10pt]\nr_{t+1} &= r_t + \\Delta t \\, \\gamma i_t\n\\end{aligned}\n$$\n\nWhere:\n\n-   $s_{t+1}$, $i_{t+1}$, and $r_{t+1}$ are the approximations for $S(t)$, $I(t)$, and $R(t)$ at the next node\n-   $s_{t}$, $i_{t}$, and $r_{t}$ are the approximations for $S(t)$, $I(t)$, and $R(t)$ at the previous node\n-   $\\Delta t$ is the step size (how far each node is spaced apart on the $t$-axis)\n-   $\\beta$ and $\\gamma$ are the transmission and recovery rate, respectively\n\n::: {.callout-note}\nThis formula is just an application of the generalized Euler's method for first-order differential equation $Y'(t)=f(t,Y(t))$, true solution $Y(t)$, and approximate solutions $y_0,\\dots,y_t,\\dots,y_b$, which are calculated at evenly spaced $t_n$ as:\n\n$y_{t+1}=y_t+ \\Delta t f(t_n,Y(t_n)$\n\nWhere again $\\Delta t$ is how far each $t_n$ are apart.\n\nSpecifically, the formulas provided above substitute the rate of change functions $\\frac{dS}{dt}$, $\\frac{dI}{dt}$, and $\\frac{dR}{dt}$ in directly.\n:::\n\nThis process can be a little confusing to grasp at first, so let's do an example.\n\nSuppose the following SIR model equations with initial values $s(0)=99$, $i(0)=1$, $r(0)=0$, transmission rate $\\beta=1.5$, and recovery rate $\\gamma=0.5$:\n\n$$\n\\begin{aligned}\n\\frac{dS}{dt} &= -1.5 \\tilde{I} S \\\\[10pt]\n\\frac{dI}{dt} &= 1.5 \\tilde{I} S - 0.5 I \\\\[10pt]\n\\frac{dR}{dt} &= 0.5 I\n\\end{aligned}\n$$\n\nThe following table illustrates the calculation process until $t=5$ with a step size of $\\Delta t=1$:\n\n| **Time** | **Approximations** | **Calculation Process** |\n|-----------------|------------------------|-------------------------------|\n| $t=0$ | $s\\left(0\\right)=99.0$<br>$i\\left(0\\right)=1.0$<br>$r\\left(0\\right)=0.0$ | — |\n| $t=1$ | $s\\left(1\\right)\\approx 97.5$<br>$i\\left(1\\right)\\approx 2.0$<br>$r\\left(1\\right)=0.5$ | $s\\left(1\\right)=99-\\left(1\\right)\\left(1.5\\right)\\left(\\frac{1}{100}\\right)\\left(99\\right)$<br>$i\\left(1\\right)=1+\\left(1\\right)\\left[\\left(1.5\\right)\\left(\\frac{1}{100}\\right)\\left(99\\right)-0.5\\left(1\\right)\\right]$<br>$r\\left(1\\right)=0+\\left(1\\right)\\left(0.5\\right)\\left(1\\right)$ |\n| $t=2$ | $s\\left(2\\right)\\approx 94.6$<br>$i\\left(2\\right)\\approx 3.9$<br>$r\\left(2\\right)\\approx 2.0$ | $s\\left(2\\right)=97.5-\\left(1\\right)\\left(1.5\\right)\\left(\\frac{2.0}{100}\\right)\\left(97.5\\right)$<br>$i\\left(2\\right)=2.0+\\left(1\\right)\\left[\\left(1.5\\right)\\left(\\frac{2.0}{100}\\right)\\left(97.5\\right)-0.5\\left(2.0\\right)\\right]$<br>$r\\left(2\\right)=0.5+\\left(1\\right)\\left(0.5\\right)\\left(2.0\\right)$ |\n| $t=3$ | $s\\left(3\\right)\\approx 89.1$<br>$i\\left(3\\right)\\approx 7.5$<br>$r\\left(3\\right)\\approx 3.4$ | $s\\left(3\\right)=94.6-\\left(1\\right)\\left(1.5\\right)\\left(\\frac{3.9}{100}\\right)\\left(94.6\\right)$<br>$i\\left(3\\right)=3.9+\\left(1\\right)\\left[\\left(1.5\\right)\\left(\\frac{3.9}{100}\\right)\\left(94.6\\right)-0.5\\left(3.9\\right)\\right]$<br>$r\\left(3\\right)=2.0+\\left(1\\right)\\left(0.5\\right)\\left(3.9\\right)$ |\n| $t=4$ | $s\\left(4\\right)\\approx 79.1$<br>$i\\left(4\\right)\\approx 13.7$<br>$r\\left(4\\right)\\approx 7.2$ | $s\\left(4\\right)=89.1-\\left(1\\right)\\left(1.5\\right)\\left(\\frac{7.5}{100}\\right)\\left(89.1\\right)$<br>$i\\left(4\\right)=7.5+\\left(1\\right)\\left[\\left(1.5\\right)\\left(\\frac{7.5}{100}\\right)\\left(89.1\\right)-0.5\\left(7.5\\right)\\right]$<br>$r\\left(4\\right)=3.4+\\left(1\\right)\\left(0.5\\right)\\left(7.5\\right)$ |\n| $t=5$ | $s\\left(5\\right)\\approx 62.8$<br>$i\\left(5\\right)\\approx 23.1$<br>$r\\left(5\\right)\\approx 14.0$ | $s\\left(5\\right)=79.1-\\left(1\\right)\\left(1.5\\right)\\left(\\frac{13.7}{100}\\right)\\left(79.1\\right)$<br>$i\\left(5\\right)=13.7+\\left(1\\right)\\left[\\left(1.5\\right)\\left(\\frac{13.7}{100}\\right)\\left(79.1\\right)-0.5\\left(13.7\\right)\\right]$<br>$r\\left(5\\right)=7.2+\\left(1\\right)\\left(0.5\\right)\\left(13.7\\right)$ |\n\n\nAs you might notice, the calculations above are very tedious, which is why Euler's method is most often calculated using code rather than by hand.\n\n::: {.callout-tip title=\"Note\"}\nThe accuracy of the solution produced by Euler's method is a direct result of what we choose the step size to be. If the step size is larger, then the curvature of the true solution will be lost since we are repeatedly taking linear approximations, resulting in an approximate solution that deviates a lot from the true solution curve. On the other hand, as the step size gets smaller, the approximate solution provided by Euler's method converges to the true solution curve.\n\nSee the section [Evaluating and Comparing Both Methods](#evaluating-and-comparing-both-methods) for a simulation demonstrating what happens when you change the step size.\n:::\n\n**Section References**\n\n@ode_book\n\n### deSolve Package in R\n\nThe deSolve Package in R contains a variety of functions that \"solve initial value problems of a system of first-order ordinary differential equations ('ODE'), of partial differential equations ('PDE'), of differential algebraic equations ('DAE'), and of delay differential equations\" [@cran_desolve]\n\n::: {.callout-note}\nThe SIR-type models we are going to cover deal with systems of first-order ordinary differential equations.\n\nBreaking up each word in this description, we have:\n\n-   \"First-order\": This just means we are only dealing with equations involving the first derivative and not subsequent derivatives (the second, third, fourth, etc. derivative)\n\n-   \"Ordinary\": The unknown function which we are trying to solve for depends only one independent variable.\n:::\n\nSince our applications will only deal with first-order ODEs, we will only cover the deSolve function `ode`, which is used to solve (as you can probably guess) initial value problems (IVPs) for first-order ordinary differential equations.\n\nThe function `ode` takes in the following relevant parameters, summarized in the table below:\n\n| **Parameter Name** | **What Does It Take In?** |\n|-------------|-----------------------------------------------------------|\n| `func` | A user-defined function that defines and returns a list of the model equations (the differential equations to be solved). |\n| `y` | A vector specifying initial values. |\n| `parms` | A vector specifying the model parameters. |\n| `times` | A vector specifying the time points at which the solution of the model equations should be returned. This determines the resolution of the overall output but not the numerical accuracy of each output point. |\n\nThe function `ode` returns a matrix whose first column is the time points specified in the input `times` and subsequent columns are the solutions to the model's state variables at those times. The state variables for an SIR model are the number or proportion of individuals susceptible, infectious, and recovered at a given time.\n\nBefore we can call `ode`, we must code the function to be passed into the parameter `func`. For a classic SIR model on the proportion of individuals in each compartment (see [The Classic SIR Epidemic Model](#the-classic-sir-epidemic-model) we do this using the following template function:\n\n```{r}\nModelFunc <- function(time,state,parameters){\n  # Extracting the state variables\n  # Since we are doing this in the context of SIR models, we have the state variables S, I, and R\n  S <- state[\"S\"]\n  I <- state[\"I\"]\n  R <- state[\"R\"]\n  \n  # Extracting the model parameters\n  # We are doing this for an SIR model, so we have two parameters - the transmission and recovery rate\n  beta <- parameters[\"beta\"]\n  gamma <- parameters[\"gamma\"]\n  \n  # Now we are going to use those previously extracted state variables and parameters to construct our model equations (differential equations)\n  dS <- -(beta*I*S)\n  dI <- (beta*I*S) - (gamma*I)\n  dR <- (gamma*I)\n  \n  # Now we will return those model equations as a list\n  return(list(c(dS,dI,dR)))\n}\n```\n\nNow all we need to do is specify the other parameters `y`, `parms`, and `times` and call `ode` with them like so:\n\n```{r}\nlibrary(deSolve)\n\n# Here we are specifying the initial values to be passed into the parameter y\n# Make sure these initial values line up exactly with the state variables extracted in the model function from before\ninitial_vals <- c(S=0.99,I=0.01,R=0)\n\n# Here we are specifying the parameters of the model and their values\n# Make sure these parameters line up exactly with the parameters extracted in the model function from before\nmodel_parameters <- c(beta=1.5,gamma=0.5)\n\n# Here we are specifying the times for which outputs are calculated\n# The closer together these times are, the higher the output resolution\noutput_times <- seq(0,50,by=1)\n\n# Now we can call the function ode like so:\noutput <- ode(func=ModelFunc,y=initial_vals,parms=model_parameters,times=output_times)\n\n# Printing the first 5 rows of the output matrix\nprint(head(output,5))\n```\n\nNow that we have this matrix of the solved SIR model equations are at specified times, we can plot it like so:\n\n```{r}\nmatplot(x = output[,\"time\"], y = output[,2:4], type = \"l\", lty = 1, xlab = \"time\", ylab = \"proportion\", main = \"Solved Example: Epidemic SIR Model\", col = c(\"blue\",\"red\",\"green\"))\n\n# Adding a legend\nlegend(\"topright\",legend = c(\"Susceptible\", \"Infectious\", \"Recovered\"), col = c(\"blue\",\"red\",\"green\"), lty = 1)\n```\n\n**Section References**\n\n@desolve_intro\n\n### Evaluating and Comparing Both Methods {#evaluating-and-comparing-both-methods}\n\nThe following table summarizes some potential benefits and drawbacks to using Euler's method or deSolve:\n\n| **Solving Method** | **Potential Benefits** | **Potential Drawbacks** |\n|--------------|-----------------------|------------------------------------|\n| Euler's Method | \\- Can be done by hand or implemented in code<br>- Simple to understand<br>- Full control over accuracy of model <br>- No external packages required | \\- Low accuracy unless an extremely small step size is used<br>- Computationally inefficient for small step sizes or complex models<br>- Can be tedious to calculate by hand |\n| deSolve Package | \\- Uses advanced solving methods with high accuracy<br>- Handles large models with many system equations well<br>- Efficient for complex models | \\- Less transparent approach; not much understanding of what is going on \"under the hood\"<br>- Requires learning new functions and syntax<br>- Depends on external packages<br>- Less control over solving method and accuracy |\n\nThe following simulation shows the difference between the solution curves produced by Euler's method and the deSolve package for different values of the model parameters and step size:\n\n<iframe src=\"http://127.0.0.1:4570\"\n        width=\"100%\"\n        height=\"700\"\n        style=\"border:none;\"></iframe>\n     \n\n## Reproduction Numbers\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Define what the basic and effective reproduction number is and recall primary differences between the two.\n\n-   Interpret the basic and effective reproduction number in context.\n\n-   Recall the formulas for the basic and effective reproduction numbers.\n\n-   Explain what the \"threshold phenomenon\" is.\n:::\n\nThe reproductive number is defined as \"the average number of secondary infectious cases caused by one infectious individual (before they recover or die or are otherwise not able to further transmit)\" [@Handel2021_IDEMA_ch5].\n\nThe table below summarizes the two types of reproduction numbers we will focus on:\n\n| **Name** | **Symbol** | **Interpretation** |\n|-------------|-------------|-----------------------------------------------|\n| Basic Reproduction Number | $R_0$ | The average number of secondary infections produced by a single infectious individual in a *completely susceptible* population. This can also be thought of as the reproduction number calculated at the beginning of an outbreak (when basically everyone is suceptible). |\n| Effective Reproduction Number | $R_{e}$ | The average number of secondary infections produced by a single infectious individual in a population with a susceptible proportion equal to $\\frac{S}{N}$ |\n\n::: {.callout-note}\nSome common misconceptions about $R_0$ and $R_e$ are:\n\n-   \"Must $R_0$ and $R_e$ be whole numbers because nobody can transmit the disease to, say, half a person?\"\n\n    -   No, $R_0$ and $R_e$ do not have to be whole numbers because they refer to *averages*, not the exact number of secondary infections produced by one person. An infectious person might infect nobody or tons of people but the reproduction numbers don't capture every detail just the overall picture of how many secondary infectious are produced.\n\n    <br>\n\n-   \"Is the reproduction number a rate?\"\n\n    -   No, the reproduction number is not a rate. Take the example of HIV and SARS, which both have $R_e\\approx4$. However, SARS has an extremely rapid spread while HIV is much slower spreading. One individual infected with SARS might cause 4 secondary infections within the span of a week while an individual with HIV most likely infects 4 other people within the span of a few years. $R_0$ and $R_e$ don't tell us anything about the timeframe of infections, so they are not rates.\n:::\n\nThe formula for the basic reproduction number is:\n\n$$\nR_0=\\frac{\\beta}{\\gamma}\n$$\n\nAnd similarly, the formula for the effective reproduction number is:\n\n$$\nR_e=\\frac{\\beta}{\\gamma} \\left( \\frac{S}{N} \\right) =R_0\\tilde{S}\n$$ These formulas should make sense, as they are multiplying the transmission rate $\\beta$ by the average duration of infection $\\frac{1}{\\gamma}$ to obtain the average number of secondary infections by one infectious individual throughout their entire duration of infectivity.\n\nThe point where these two formulas differ is in their assumption about the proportion of susceptible individuals in the population. $R_0$ assumes a completely susceptible population, so it is multiplying the expression $\\frac{\\beta}{\\gamma}$ by an invisible $1$. Meanwhile, $R_e$ assumes a susceptible proportion equal to $\\frac{S}{N}$ hence the final expression $\\frac{\\beta}{\\gamma}(\\frac{S}{N})$.\n\nMake sure you understand the definitions and intuition behind the formulas for $R_0$ and $R_e$. The [next section](#the-threshold-phenomenon) on the threshold phenomenon applies the reproduction number in learning how to control the spread of infection.\n\n**Section References**\n\n@Handel2021_IDEMA_ch5\n\n### The Threshold Phenomenon {#the-threshold-phenomenon}\n\nFirst described by Kermack and McKendrick, the threshold phenomenon refers to the critical point whereby an infection will either invade the population or fail to. To find this critical point, observe the change in the proportion of infectious individuals given by:\n\n$$\n\\frac{d\\tilde{I}}{dt} = \\beta \\tilde{I} \\tilde{S} - \\gamma \\tilde{I}\n$$ \n\nFactoring out the $\\tilde{I}$, we have:\n\n$$\n\\frac{d\\tilde{I}}{dt} = \\tilde{I}(\\beta \\tilde{S} - \\gamma)\n$$ \n\nIf we wish to find the point at which the infection either invades or fails to, we can solve for when $\\frac{d\\tilde{I}}{dt}<0$ (the proportion of infectious individuals is decreasing, or the disease is \"dying off\") and $\\frac{d\\tilde{I}}{dt}>0$ (the proportion of infectious individuals is increasing, or the disease is \"growing\").\n\nFirst, let's analyze when $\\frac{d\\tilde{I}}{dt}<0$:\n\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{I}}{dt} &< 0  && \\text{Condition that the infected population is decreasing} \\\\[10pt]\n\\tilde{I}(\\beta \\tilde{S} - \\gamma) &< 0  && \\text{Substitute } \\frac{d\\tilde{I}}{dt} = \\tilde{I}(\\beta \\tilde{S} - \\gamma) \\\\[10pt]\n\\beta \\tilde{S} - \\gamma &< 0  && \\text{Divide both sides by } \\tilde{I} > 0 \\\\[10pt]\n\\tilde{S} &< \\frac{\\gamma}{\\beta}  && \\text{Add } \\gamma \\text{ to both sides, then divide by } \\beta > 0\n\\end{aligned}\n$$\n\nReproducing this procedure, we obtain the following similar result:\n\n$$\n\\frac{d\\tilde{I}}{dt} > 0 \n\\;\\Longleftrightarrow\\; \n\\tilde{S} > \\frac{\\gamma}{\\beta}\n$$\n\nFrom this, we can deduce that for an infection to even invade the population and start spreading, the initial proportion of susceptibles must be greater than $\\frac{\\gamma}{\\beta}$. This result is what is specifically known as the *threshold phenomenon*, with $\\frac{\\gamma}{\\beta}$ known as the *threshold value*. Notice that $\\frac{\\gamma}{\\beta}$ is exactly equal to the inverse of the basic reproduction number $\\frac{1}{R_0}$, which means we can also rewrite these conditions like so:\n\n$$\n\\begin{aligned}\n\\text{Disease will not invade the population and / or spread:}\n\\qquad\n\\tilde{S} &< \\frac{1}{R_0}\n\\\\[10pt]\n\\text{Disease will invade the population and / or spread:}\n\\qquad\n\\tilde{S} &> \\frac{1}{R_0}\n\\end{aligned}\n$$\n\nThe simulation below let's you see the threshold phenomenon in action:\n\n<iframe src=\"http://127.0.0.1:4567\"\n        width=\"100%\"\n        height=\"700\"\n        style=\"border:none;\"></iframe>\n    \n\n::: {.callout-note}\nTry changing the initial proportion of susceptible individuals $S(0)$ to be above and below the rounded threshold value ($\\frac{\\gamma}{\\beta}$ ) shown. Notice that the proportion of infected individuals never increases if $S(0)<\\frac{\\gamma}{\\beta}$ but does increase if $S(0)>\\frac{\\gamma}{\\beta}$.\n:::\n\nConnecting this even further to reproduction numbers, we can rewrite the inequalities found above in terms of $R_e$ as follows:\n\n$$\n\\begin{aligned}\n\\qquad\n\\tilde{S} &< \\frac{\\beta}{\\gamma}\n\\qquad \\Longleftrightarrow \\qquad\nR_e < 1\n\\\\[10pt]\n\\qquad\n\\tilde{S} &> \\frac{\\beta}{\\gamma}\n\\qquad \\Longleftrightarrow \\qquad\nR_e > 1\n\\end{aligned}\n$$\n\nThe result above is a really important one: it tells us that $R_e$ is another threshold for determining whether or not a disease will spread. Specifically, if $R_e<1$, the disease is dying off but if $R_e>1$ the disease is spreading.\n\nThis should come as no surprise though, as it can be inferred from the definition of $R_e$ itself: if every single infectious person in the population (assuming the true value for the susceptible population, unlike $R_0$ which assumes a completely naive population), on average \"replaces\" themselves with more than $1$ infection, the disease will spread. Moreover, the point at which $R_e$ reaches exactly $1$ marks the maximum for the infected population since it is the point at which the disease goes from spreading (number of individuals infected rising) to dying off (number of individuals infected falling).\n\nThe simulation below demonstrates how the infected population increases, decreases, and reaches its maximum at different values of $R_e$:\n\n<iframe src=\"http://127.0.0.1:4568\"\n        width=\"100%\"\n        height=\"700\"\n        style=\"border:none;\"></iframe>\n     \n\n::: {.callout-note}\nNotice how $R_e$ starts off at its highest (when the population is almost entirely susceptible and it is equal to $R_0$), then decreases over time to be equal to $1$. At the point $R_e=1$, the proportion of infected individuals reaches a maximum. Then, as $R_e$ further decreases below $1$ the proportion of infected individuals starts decreasing as the epidemic \"dies off.\"\n:::\n\nTry expanding the window size in the simulation above and observe what happens to $R_e$ as $t \\rightarrow \\infty$. Notice that $R_e$ never reaches $0$! This demonstrates another important result: for an epidemic to end, it is not necessary to completely exhaust the susceptible population and attain $R_e=0$. The epidemic will start to end its course as soon as the proportion of susceptibles dips low enough to where $R_e<1$. When this happens, the infectious individuals will, on average, no longer be \"replacing\" themselves with another infectious person despite there still being a non-zero population of susceptible people. If this goes on for a long enough time, the chain of transmission will break because there will be no more infectious people to spread the infection not because there were no more susceptible people to infect. This means that at the end of every epidemic, there will always be some people who were never infected and are still susceptible.\n\nINSERT FLOW DIAGRAM THAT SHOWS EFF R AT VARIOUS FINITE STAGES AND ARROWS BETWEEN PEOPLE SPREADING THE INFECTION AND SAY THAT IF THERE IS LIKE 50 INFECTIOUS PEOPLE AND AN RE = 0.1 THEN 5 PEOPLE WILL GET INFECTED NEXT STAGE; ONCE THIS AVERAGE DIPS BELOW 1 PERSON FOR THE WHOLE INFECTIOUS POPULATION, DISEASE DIES OFF\n\nOf course, one of our primary goals is to expedite the natural decrease of $R_e$ to be below $1$ as quickly as possible, thus reducing and eventually fully stopping the spread of infection. One of the most effective public health measures to accomplish this is vaccination [@vaccines13050479]. The [next section](#choosing-how-many-people-to-vaccinate) answers the crucial following question: \"How many vaccinated people is enough?\".\n\n**Section References**\n\n@keeling_modeling_2008\n\n### Choosing How Many People to Vaccinate {#choosing-how-many-people-to-vaccinate}\n\nRecall from the [previous section](#the-threshold-phenomenon) that the disease will begin to die off when $R_e$ drops below $1$. The proportion of susceptible individuals $\\tilde{S}$ can be considered to be equal to $1-i$, where $i$ is the proportion of people in the population who are infectious or immune to the disease. We can rearrange the expression $R_e<1$ and solve for $i$:\n\n<br>\n\n$$\n\\begin{aligned}\nR_e &< 1 && \\text{Condition for disease to die off} \\\\[10pt]\nR_0 \\tilde{S} &< 1 && \\text{Definition of $R_e$} \\\\[10pt]\nR_0 (1-i) &< 1 && \\text{$\\tilde{S}=1-i$} \\\\[10pt]\ni &> 1-\\frac{1}{R_0} && \\text{Rearranging and solving for $i$}\n\\end{aligned}\n$$\n\n<br>\n\nAt the beginning of the outbreak, when nearly all individuals are susceptible and there are very few infectious, the proportion of individuals immune to the disease or infectious with it $i$ can be considered approximately equal to the proportion of individuals *successfully* vaccinated against the disease. This is because, generally speaking, vaccination confers immunity, though most of the time only temporary, to a disease (https://www.who.int/news-room/feature-stories/detail/how-do-vaccines-work). Since we are analyzing a relatively small time-frame with epidemics, the temporary nature of vaccine-conferred immunity can be safely disregarded.\n\nNotice the emphasis on the word \"successfully.\" This is because most vaccines are not $100%$ effective; there will always be a percentage of people, though however small, that are vaccinated but can still contract the disease. Assuming a vaccine efficacy rate of $e$, or the proportion of people who are vaccinated $p$ that are truly granted immunity, the proportion of individuals successfully vaccinated is $i=ep$. We can rearrange the expression found previously to find the proportion of the population $p$ that should be vaccinated at the start of the outbreak:\n\n<br>\n\n$$\n\\begin{aligned}\ni &> 1-\\frac{1}{R_0} && \\text{Minimum proportion of immune individuals i} \\\\[10pt]\nep &> 1-\\frac{1}{R_0} && \\text{Considering i=ep} \\\\[10pt]\np &> \\frac{1}{e}\\left(1-\\frac{1}{R_0} \\right) && \\text{Rearranging for p}\n\\end{aligned}\n$$\n\n<br>\n\nThis means that, for a vaccine with an efficacy rate $e$, at the proportion of people that should be vaccinated at the start of an outbreak to prevent further spread should be at least $\\frac{1}{e}(1-\\frac{1}{R_0}$. Not everyone in the population must be vaccinated to stop the spread of a disease, an idea known as *herd immunity*.\n\nHowever, sometimes herd immunity cannot be obtained. Take the case when $R_0=3$ and the best available vaccine has an efficacy rate of $e=0.6$ (meaning that of the people who are vaccinated, only about $60%$ of them will actually be immune and unable to contract the disease). Using the formula above, we find that the proportion of people who are vaccinated at the beginning of the outrbreak must be at least $\\frac{1}{0.6}(1-\\frac{1}{3})\\approx1.1$. However, this is impossible: we cannot possible vaccinate more than $100%$ of the population! This means that, due to a combination of the high transmissibility of the disease and the relatively low vaccine efficacy rate, even if $100%$ of the population were to be vaccinated, there would still be enough susceptible people (i.e. people whose vaccines were not effective) for an outbreak to occur.\n\n::: {.callout-note}\nNote that the above calculations and statements are assuming ideal vaccination practices at the beginning of an outbreak when nearly all individuals are susceptible and almost none are recovered or infectious. If vaccination is implemented mid-outbreak, when the number of recovered individuals with natural immunity and infectious people are not negligible, the calculations must be modified. In general, fewer individuals will have to be vaccinated than at the beginning of an outbreak since the proportion of susceptible individuals $\\tilde{S}$ will be equal to the complement of the sum of: the proportion of people who are infectious, those who have natural immunity due to recovery, and those who are successfully vaccinated.\n:::\n\n**Section References**\n\n@Handel2021_IDEMA_ch5\n\n## Example of the Classic Epidemic Model\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Identify examples of situations where the classic epidemic model is a useful tool for modeling.\n:::\n\nA disease commonly modeled using SIR-type models is measles due to its high infectivity and life-long immunity once recovered [@review_measles]. \n\naverage infectious period duration in Bjornstad paper reported a \"followed by a 6–7 d infective period\"\n\nhttps://esajournals.onlinelibrary.wiley.com/doi/full/10.1890/0012-9615%282002%29072%5B0169%3ADOMEES%5D2.0.CO%3B2#i0012-9615-72-2-169-anderson5\n\nFind beta using MLE\n\nJustification for not including E in model (Bjornstad paper): \"Humans, thus, enter the susceptible host population after a short delay. Following this, the high transmission rates ensured that 95% of all people in (prevaccination) urban areas were infected by the age of 15, and essentially everybody by the age of 20 (Anderson 1982). In the prevaccination era, the mean age of infection was ∼4–5 yr (Anderson and May 1991).\" \n\n\n## The Classic Endemic Model\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Recall the classic endemic model's equations.\n\n-   Differentiate the classic endemic model from the epidemic model.\n:::\n\nRecalling the information in [the section](#the-classic-sir-epidemic-model) on introducing the classic SIR epidemic model, the classic epidemic model assumes no demographics (births and deaths) in the population. This is because epidemics occur in such a relatively short timeframe, so the inclusion of births and deaths adds unnecessary complexity since so few will occur over this period.\n\nHowever, epidemic models are not suitable for all disease; there are some diseases that do not conclude their spread sufficiently fast to neglect the births and deaths that occur during that time. This is when the SIR model with demographics, also known commonly as the classic endemic model, comes in. The classic endemic model includes birth and death rates, but makes the following key assumptions about them:\n\n-   Every individual in the population has a natural \"lifespan\" of $\\frac{1}{\\mu}$ years, where $\\mu$ is the rate at which individuals die due to natural causes\n\n    -   $\\mu$ is independent of the disease and does not represent the pathogenicity of the disease, or its ability to cause death\n\n-   No deaths outside of natural ones dictated by the rate $\\mu$ occur; in other words, there are no separate disease related deaths and $\\mu$ is the crude death rate, or the death rate across people in all demographic groups and disease statuses (susceptible, infected, or recovered)\n\n-   $\\mu$ also represents the population's crude birth rate as well\n\n    -   This ensure that the total population size does not change as time goes on; as such, $N$ is a constant in the endemic SIR just as it is in the epidemic model\n\n-   Every individual is born into the susceptible population\n\n    -   Although for many disease (like measles for example) newborns are born with passive immunity due to the passing down of maternal antibodies, the average age at which passive immunity is lost is much lower than the typical age of first infection in developed countries. This tells us that it is reasonable to consider all newborns as being immediately susceptible since the time to their first infection is most likely independent of their initial fading immunity at birth. This is not true of diseases that have a very small mean age of infection, however, since an infection can happen as soon as passive immunity ends.\n\n**Section References**\n\n@keeling_modeling_2008\n\n::: {.callout-note}\nThe other assumptions made for the classic epidemic SIR apply to the endemic SIR model as well. We are just simply adding these new assumptions about the characteristics of the birth and death rates in the population. These assumptions are common but it should be noted that not all SIR models with demographics will make the same assumptions as above.\n:::\n\nThe flowchart for the classic endemic model can be seen below:\n\nINSERT FLOWCHART OF ENDEMIC MODEL\n\nFrom this flowchart, we can deduce the following equations for the number of people in each compartment according to the endemic SIR model:\n\n$$\n\\begin{aligned}\n\\frac{dS}{dt} &= \\mu-\\beta \\tilde{I} S - \\mu S \\\\[10pt]\n\\frac{dI}{dt} &= \\beta \\tilde{I} S - \\gamma I - \\mu I\\\\[10pt]\n\\frac{dR}{dt} &= \\gamma I - \\mu R\n\\end{aligned}\n$$\n\nAnd just like before, we can divide every equation above by the constant population size $N$ to obtain the following equations for the proportion of individuals in each compartment:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt} &= \\mu-\\beta \\tilde{I} \\tilde{S} - \\mu \\tilde{S} \\\\[10pt]\n\\frac{d\\tilde{I}}{dt} &= \\beta \\tilde{I} \\tilde{S} - \\gamma \\tilde{I} - \\mu \\tilde{I}\\\\[10pt]\n\\frac{d\\tilde{R}}{dt} &= \\gamma \\tilde{I} - \\mu \\tilde{R}\n\\end{aligned}\n$$\n\nNotice that the force of infection for the endemic model is the same as the epidemic model ($\\lambda=\\beta \\tilde{I}$.\n\nThe following sections are mostly reviews of concepts covered previously in the epidemic model. For this reason, they are mostly short sections but do cover important distinctions between the epidemic and endemic model, including how their reproduction numbers are calculated and how to solve them using deSolve just to name a few.\n\n## Formulating the Death Rate\n\nFIND SOURCE ON FORMULATING DEATH RATE; I ASSUME WE CAN SIMPLY FIND SOURCES THAT SAY THE DEATH RATE IS 1/AVG LIFE EXPECTANCY IN POPULATION\n\n## Solving the Endemic SIR Model - Example\n\nThe endemic SIR model can be solved using many of the same methods as the epidemic SIR model. In [the previous section](#solving-sir-equations) on solving the epidemic SIR model, we covered two main methods of doing so: Euler's method and the deSolve package in R.\n\nBoth of these methods can be used to solve the endemic model as well, but we will only show an example of solving the endemic model using deSolve since Euler's method is quite lengthy and is the exact same process as for the epidemic model just with different SIR equations.\n\nBelow is a complete example of using the deSolve package to solve an endemic SIR model and plotting the results:\n\n```{r}\nlibrary(deSolve)\n\nModelFunc <- function(time,state,parameters){\n  # Extracting the state variables\n  # Same compartments as before: susceptible, infectious, and recovered\n  S <- state[\"S\"]\n  I <- state[\"I\"]\n  R <- state[\"R\"]\n  \n  # Extracting the model parameters\n  # We now have three parameters - the transmission rate, recovery rate, and mortality rate\n  beta <- parameters[\"beta\"]\n  gamma <- parameters[\"gamma\"]\n  mu <- parameters[\"mu\"]\n  \n  # Using the previously extracted state variables and parameters to construct our model equations (differential equations)\n  dS <- mu - (beta*I*S) - mu*S\n  dI <- (beta*I*S) - (gamma*I) - mu*I\n  dR <- (gamma*I) - mu*R\n  \n  # Returning model equations as a list\n  return(list(c(dS,dI,dR)))\n}\n\n# Specifying the initial values to be passed into the parameter y\n# Make sure these initial values line up exactly with the state variables extracted in the model function from before\ninitial_vals <- c(S=0.99,I=0.01,R=0)\n\n# Specifying the parameters of the model and their values\n# Make sure these parameters line up exactly with the parameters extracted in the model function from before\nmodel_parameters <- c(beta=1.5,gamma=0.3,mu=0.2)\n\n# Times for which outputs are calculated\n# The closer together these times are, the higher the output resolution\noutput_times <- seq(0,50,by=1)\n\n# Now we can call the function ode\noutput <- ode(func=ModelFunc,y=initial_vals,parms=model_parameters,times=output_times)\n\n# Plotting the output\nmatplot(x = output[,\"time\"], y = output[,2:4], type = \"l\", lty = 1, xlab = \"time\", ylab = \"proportion\", main = \"Solved Example: Endemic SIR Model\", col = c(\"blue\",\"red\",\"green\"))\n\n# Adding a legend\nlegend(\"topright\",legend = c(\"Susceptible\", \"Infectious\", \"Recovered\"), col = c(\"blue\",\"red\",\"green\"), lty = 1)\n```\n\n::: {.callout-note}\nNotice that the curves above seem to \"even out\" after a while? This is a really important distinction between the epidemic and endemic SIR model, and is explained in detail in [the future section on model equilibriums](#disease-free-and-endemic-equilibrium). \n:::\n\n## Reproduction Numbers\n\nThe basic and effective reproduction numbers for the endemic SIR model have the same interpretation as they do for the epidemic SIR model. Refer back to [this section](#reproduction-numbers) on reproduction numbers in the epidemic SIR model if you need a refresher of these definitions. \n\nAlthough they have the same interpretations before, the formulas for the basic and reproductive number are different for the endemic SIR model. \n\nFirst, let's formulate the basic reproductive number $R_0$ for the endemic SIR model. We still utilize $\\beta$ as the per-capita transmission rate but instead of considering the average time an individual is infectious to be $\\frac{1}{\\gamma}$ (like it is for the epidemic SIR model), we consider it to be $\\frac{1}{\\gamma+\\mu}$. On a conceptual level, this is justified because there are now two ways to leave the infectious class: recovery or death. Before in the epidemic model, there was only one way to become noninfectious---through recovery. \n\nMultiplying the tranmission rate $\\beta$ by the average time an individual will stay infectious $\\frac{1}{\\gamma+\\mu}$, we obtain the the basic reproduction number $R_0$ for the epidemic SIR model:\n\n$$\nR_0=\\frac{\\beta}{\\gamma+\\mu}\n$$\n\n::: {.callout-note}\nThis basic reproduction number for the endemic model is generally similar to, but always smaller than, the basic reproduction number for the epidemic model since the natural morality rate reduces the average time an individual is infectious (we now consider the possibility that individuals can die to natural causes while infectious, thus reducing their \"infective potential\"). \n:::\n\nThe effective reproduction number $R_e$ for the endemic model is quite similar to the epidemic model. It is still found by multiplying the basic reproduction number $R_0$ by the proportion of susceptible individuals in the population $\\tilde{S}$ like so:\n\n$$\nR_e=R_0 \\tilde{S}=\\left(\\frac{\\beta}{\\gamma+\\mu} \\right) \\tilde{S}\n$$\n\n## Disease Free and Endemic Equilibrium\n\n::: {.callout-tip title=\"Learning Objectives\"}\nBy the end of this section, you should be able to:\n\n-   Define what an equilibrium is the context of a system of differential equations.\n\n-   Find the values where the disease-free and endemic equilibrium occur.\n\n-   Recall when each equilibrium type occurs in relation to R0 and justify it based on the definition of R0.\n:::\n\nThe inclusion of births in the endemic model means there is a constant \"replenishing\" of the susceptible population. This allows for the disease to persist in the population in the long-term, unlike the epidemic model which always ends in the disease \"dying off.\" \n\nTo analyze the long-term behavior of the endemic model, we start by analyzing what the model equations look like at *equilibrium*, or the point when $\\frac{dS}{dt}=\\frac{dI}{dt}=\\frac{dR}{dt}=0$. \n\n::: {.callout-note}\nIt is important to note that equilibrium doesn't mean a lack of individuals flowing between each compartment but rather a *balanced* flow of individuals between each compartment. This means that the same number or proportion of individuals are entering and leaving each compartment at a given time, so the net change in the number or proportion of individuals in each compartment is $0$. \n\nWe can understand this just by looking at the model equations themselves. Take the susceptible population as an example, dictated by the rate:\n\n$$\n\\frac{dS}{dt} = \\mu-\\beta \\tilde{I} S - \\mu S\n$$\n\nWe can see that for $\\frac{dS}{dt}$ to be equal to $0$, it is not necessary that $0$ people are entering the susceptible population (i.e. being born) and $0$ people are leaving the susceptible population (i.e. getting infected). It is simply necessary that the flow rate *into* the susceptible population (given by the birth rate term \\mu) is the same as the flow rate *out* of the susceptible population (given by the infection term $\\beta \\tilde{I} S$ and the death rate term $\\mu S$). \n:::\n\nThe equilibrium of a system of differential equations is found by setting each rate of change equal to $0$ and finding the solution(s) of the resulting system:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt} = 0, \\quad \\frac{d\\tilde{I}}{dt} = 0, \\quad \\frac{d\\tilde{R}}{dt} = 0 \n& \\quad && \\text{Equilibrium set up} \\\\[10pt]\n\\frac{d\\tilde{I}}{dt} = \\beta \\tilde{I} \\tilde{S} - \\gamma \\tilde{I} - \\mu \\tilde{I} = 0 \n& \\quad && \\text{Focus on the infected equation} \\\\[10pt]\n\\tilde{I}(\\beta \\tilde{S} - \\gamma - \\mu ) = 0 \n& \\quad && \\text{Factor out } \\tilde{I} \\text{ to solve for equilibrium} \\\\[10pt]\n\\tilde{I}^* = 0 \\quad \\text{or} \\quad \\tilde{S}^* = \\frac{\\gamma + \\mu}{\\beta}=\\frac{1}{R_0}\n& \\quad && \\text{Two potential solutions}\n\\end{aligned}\n$$\n\n\n\n::: {.callout-note}\nNote that above equilibrium system is solved using the endemic model equations for the proportion, not number, of individuals in each compartment. A similar procedure can be replicated to solve for the number of individuals in each compartment at the equilibrium. \n\nThe values at which the equilibrium occur are often denoted using an asterisk ($*$) above the variable. For consistency and clarity, the values at which the equilibrium occurs for the proportion endemic model will be denoted with $\\tilde{S}^*$, $\\tilde{I}^*$, and $\\tilde{R}^*$. Likewise, the values at which the equilibrium occurs for the number endemic model will be denoted with $S^*$, $I^*$, and $R^*$. \n:::\n\nNotice that we actually have two possible solutions for the equilibrium, one where $\\tilde{I}^*=0$ and another when $\\tilde{S}^* = \\frac{1}{R_0}$. We can solve for the values of the other variables at these points, starting with when $\\tilde{I}^*=0$:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt}=\\mu - \\mu \\tilde{S}=0 \\implies \\tilde{S}^*=1\n& \\quad && \\text{Substituting } \\tilde{I}=0 \\text{ into } \\frac{d\\tilde{S}}{dt}=0 \\\\[10pt]\n\\frac{d\\tilde{R}}{dt}= - \\mu \\tilde{R} =0 \\implies \\tilde{R}^*=0\n& \\quad && \\text{Substituting } \\tilde{I}=0 \\text{ into } \\frac{d\\tilde{R}}{dt}=0 \\\\[10pt]\n\\end{aligned}\n$$\n\nThis gives us one set of values where an equilibrium can occur:\n\n$$\n(\\tilde{S}^*,\\tilde{I}^*,\\tilde{R}^*)=(1,0,0)\n$$\nThe other set of values corresponding to an equilibrium point can be obtained by solving for the values of $\\tilde{I}^*$ and $\\tilde{R}^*$ when $\\tilde{S}^*=\\frac{1}{R_0}$:\n\n$$\n\\begin{aligned}\n\\frac{d\\tilde{S}}{dt}=\\mu - \\beta \\tilde{I} \\left(\\frac{1}{R_0} \\right) -\\mu \\tilde{S}=0 \\implies \\tilde{I}^*=\\frac{\\mu}{\\beta}(R_0-1)\n& \\quad && \\text{Substituting } \\tilde{S}=\\frac{1}{R_0} \\text{ into } \\frac{d\\tilde{S}}{dt}=0 \\\\[10pt]\n\\tilde{S}+\\tilde{I}+\\tilde{R}=1 \\implies \\tilde{R}^*=1-\\frac{1}{R_0}-\\frac{\\mu}{\\beta}(R_0-1)\n& \\quad && \\text{Using total population equation}\\\\[10pt]\n\\end{aligned}\n$$\n\nNow we have both sets of values where an equilibrium occurs:\n\n$$\n\\begin{aligned}\n(\\tilde{S}^*,\\tilde{I}^*,\\tilde{R}^*) &= (1,0,0) \\\\[10pt]\n(\\tilde{S}^*,\\tilde{I}^*,\\tilde{R}^*) &= \\left(\\frac{1}{R_0}, \\frac{\\mu}{\\beta}(R_0-1), 1 - \\frac{1}{R_0} - \\frac{\\mu}{\\beta}(R_0-1)\\right)\n\\end{aligned}\n$$\n\nEach of these two sets of values correspond to their own equilibrium points which have their own special names, summarized in the table below:\n\n\n| **Name** | **$(\\tilde{S}^*,\\tilde{I}^*,\\tilde{R}^*)$** | **What Is Happening At This Point?** |\n|-------------|-------------|-----------------------------------------------|\n| Disease-Free Equilibrium | $(1,0,0)$ | A stable point wherein the the disease has completely left the population and all recovered individuals have died due to natural causes. It can be interpreted as a population \"untouched\" by the disease. |\n| Endemic Equilibrium | $\\left(\\frac{1}{R_0}, \\frac{\\mu}{\\beta}(R_0-1), 1 - \\frac{1}{R_0} - \\frac{\\mu}{\\beta}(R_0-1)\\right)$ | A stable point wherein the disease has established itself in the population and become *endemic*. A disease is endemic when \"it is consistently present but limited to a particular region,\" which in the case of the endemic SIR model is our particular region of study [@endemic_article]. |\n\nThe next question that arises is when do these equilibrium points occur? The answer lies in the value of $R_0$: the endemic equilibrium is *asymptotically stable* when $R_0>1$, otherwise if $R_0\\leq1$ then the disease-free equilibrium is stable. \n\n:::{.callout-note}\nThe stability of model systems can be a difficult concept to grasp, but in general we can think of the above statement as saying that when $R_0\\leq 1$ or the initial proportion of infected individuals equals 0, all valid solution paths (solutions which exist for all positive time and are unique) approach the disease-free equilibrium given by $(\\tilde{S}^*,\\tilde{I}^*,\\tilde{R}^*)=(1,0,0)$. Similarly, when $R_0>1$, all valid solution paths with an intitial proportion of infected individuals greater than $0$ will approach the endemic equilibrium [@hethcote_math_infection].\n\nThis makes sense intuitively, as if $R_0\\leq1$ the pathogen can't invade the population since every new infectious individual would only, on average, pass on the disease to one or fewer hosts. Eventually the chain of transmission would break and the disease-free equilibrium  would be approached asymptotically (over time). \n\nLikewise, if $R_0>1$ the pathogen can invade the population with even just the smallest introduction of infectious individuals since they will successively infect more people (who will then infect more even more people, etc.). The chain of transmission will not break either like it does in the epidemic SIR model since the population of susceptibles is constantly being \"replenished\" via new births, so the disease-free equilibrium is approached asymptotically. \n:::\n\nThe simulation below lets you see which equilibrium will be approached for different values of $R_0$ and initial proportion of infected individuals:\n\n<iframe src=\"http://127.0.0.1:4569\"\n        width=\"100%\"\n        height=\"700\"\n        style=\"border:none;\"></iframe>\n     \n\n:::{.callout-note}\nTry setting the transmission rate to $1$, the recovery rate to $0.7$, and the birth / death rate to $0.4$. Notice that under these model parameters, the basic reproduction number $R_0$ is barely under $1$ ($R_0\\approx0.909$). Now try changing the initial proportion of infected individuals and observe what happens to the SIR curves over time. Even for an initial infected proportion of $1$ (at the start everyone is infected), the curves still approach the disease-free equilibrium as expected! \n\nNow try setting the parameters to result in $R_0>1$ and observe the proportion of susceptible, infected, and recovered individuals as time progresses (you can see the exact proportions by hovering over each curve). Do these line up exactly with values at the endemic equilibrium point calculated before? \n:::\n\n\n\n\n\n\n\n\n\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"SIR_Module_RD.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","title":"SIR Module Rough Draft","editor":"visual","bibliography":["../reference.bib"],"toc-location":"right"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["live-html"]}